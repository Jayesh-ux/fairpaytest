# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#                    FAIRPAY SOLUTION - FULL STACK MVP ROADMAP
#                          Single Source of Truth Document
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Last Updated: 2026-01-19 14:20 IST
Project Start: 2026-01-18
Reference Site: https://www.fairpaysolution.com/

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                              PROJECT OVERVIEW
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## What We're Building 

A production-grade loan advisory platform for FairPay Solutions with:
- Client Portal: Loan case tracking, document upload, real-time chat
- Admin Dashboard: Case management, document review, leads, reviews moderation  
- Public Site: Existing marketing pages + new database-backed forms
- Backend APIs: Full REST API replacing Google Sheets

## Current State (Before Migration)

- Framework: Vite + React + TypeScript (SPA)
- Styling: Tailwind CSS + shadcn/ui âœ“ Already in place
- Pages: 17 existing marketing/legal pages
- Components: 80+ components
- Forms: Currently using Google Sheets backend
- Deployment: Vercel

## Target State (After Migration)

- Framework: Next.js 14 App Router (SSR + API Routes)
- Styling: Tailwind CSS + shadcn/ui (preserved)
- Database: PostgreSQL (local â†’ AWS RDS)
- File Storage: Local filesystem â†’ AWS S3
- Auth: NextAuth.js (Google OAuth + Email OTP ready)
- ORM: Prisma

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                              PROGRESS TRACKER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## Phase 1: Foundation & Setup
Status: [x] COMPLETED âœ… (2026-01-18)

[x] 1.1 Migrate from Vite to Next.js App Router
    - [x] Install Next.js 14 dependencies
    - [x] Create next.config.js
    - [x] Setup app/ directory structure
    - [x] Create app/(marketing)/ with layout and home page
    - [x] Migrate components to /components (Header, Footer, home sections)
    - [x] Update all components to use next/link instead of react-router-dom
    - [x] Test build and dev server âœ“ Running on localhost:3000

[x] 1.2 Setup Prisma & Database
    - [x] Install Prisma v5 and @prisma/client
    - [x] Create prisma/schema.prisma (12 models, all enums, indexes)
    - [x] Setup PostgreSQL via Docker (fairpay-postgres container)
    - [x] Run prisma db push - all tables created
    - [x] Create and run seed script (2 admins, 5 sample reviews)

[x] 1.3 Setup NextAuth
    - [x] Install next-auth v5 beta
    - [x] Create auth configuration (lib/auth.ts)
    - [x] Setup Google OAuth provider with credentials
    - [x] Configure session/JWT with role extension
    - [x] Create middleware for route protection (/portal, /admin)

[x] 1.4 Environment Configuration
    - [x] Create .env and .env.local with all variables
    - [x] Configure DATABASE_URL for Docker PostgreSQL
    - [x] Configure GOOGLE_CLIENT_ID and GOOGLE_CLIENT_SECRET
    - [x] Configure NEXTAUTH_SECRET and NEXTAUTH_URL

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

## Phase 2: API Layer
Status: [x] COMPLETED âœ…

[x] 2.1 Auth APIs
    - [x] /api/auth/[...nextauth] - NextAuth routes
    - [x] getCurrentUser helper function (lib/auth.ts)
    - [x] isAdmin helper function (lib/auth.ts)

[x] 2.2 Ticket APIs âœ… COMPLETED
    - [x] GET /api/tickets - List tickets (user's own / admin all)
    - [x] POST /api/tickets - Create new ticket
    - [x] GET /api/tickets/[id] - Get ticket with events, docs, messages
    - [x] PATCH /api/tickets/[id] - Update stage, status (admin)
    - [x] DELETE /api/tickets/[id] - Delete ticket (admin)
    - [x] GET /api/tickets/[id]/events - Get timeline events
    - [x] POST /api/tickets/[id]/events - Add timeline event (admin)
    - [ ] POST /api/tickets/[id]/documents - Upload document (user)
    - [x] GET /api/tickets/[id]/messages - Get chat messages
    - [x] POST /api/tickets/[id]/messages - Send message

[x] 2.3 Document APIs
    - [x] PATCH /api/documents/[id] - Approve/reject (admin)

[x] 2.4 Callback APIs
    - [x] GET /api/callbacks - List leads (admin)
    - [x] POST /api/callbacks - Submit lead (public)
    - [x] PATCH /api/callbacks/[id] - Update status/notes (admin)

[x] 2.5 Review APIs
    - [x] GET /api/reviews - List approved (public) / all (admin)
    - [x] POST /api/reviews - Submit review (public)
    - [x] PATCH /api/reviews/[id] - Approve/reject (admin)

[x] 2.4 Callback APIs
    - [x] POST /api/callbacks - Submit callback (public)
    - [ ] GET /api/callbacks - List all callbacks (admin) - route exists, needs auth
    - [ ] PATCH /api/callbacks/[id] - Update status/notes (admin)

[x] 2.5 Review APIs
    - [x] POST /api/reviews - Submit review (public)
    - [x] GET /api/reviews - Get approved reviews (public) âœ“ Working on homepage
    - [ ] PATCH /api/reviews/[id] - Approve/reject (admin)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

## Phase 3: Client Portal
Status: [~] IN PROGRESS

[x] 3.1 Portal Layout
    - [x] Create /portal layout with sidebar
    - [x] Navigation (Dashboard, Tickets, Documents, Messages, Profile)
    - [x] Mobile responsive menu with slide-out drawer
    - [x] User info display with avatar
    - [x] Sign out functionality
    - [x] Navigation sidebar
    - [x] Top header with user profile
    - [x] Mobile responsiveness

[x] 3.2 Portal Dashboard (/portal)
    - [x] Stats summary (tickets, documents, progress)
    - [x] Recent tickets list
    - [x] Quick actions (New Ticket, Upload Doc)

[x] 3.3 Ticket List (/portal/tickets)
    - [x] Grid/List view of all user tickets
    - [x] Search and grouping

[x] 3.4 New Ticket Form (/portal/tickets/new)
    - [x] Multi-step wizard
    - [x] Loan details and amounts

[x] 3.5 Ticket Detail (/portal/tickets/[id])
    - [x] Visual stage/progress tracker
    - [x] Timeline view (TicketEvents)
    - [x] Real-time chat panel
    - [x] Document management tab

[x] 3.6 Auth Pages
    - [x] Sign-in page (/auth/signin) with Google OAuth

[x] 3.7 Documents Page (/portal/documents)
    - [x] Unified document management across all tickets

[x] 3.8 Messages Page (/portal/messages - Placeholder)
    - [x] Direct access to advisor chat via ticket list

[x] 3.9 Profile Page (/portal/profile)
    - [x] User details and security settings

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

## Phase 4: Admin Dashboard
Status: [x] COMPLETED âœ…

[x] 4.1 Admin Layout
    - [x] Create /admin layout with dark theme sidebar
    - [x] Navigation (Dashboard, Tickets, Callbacks, Reviews, Users)
    - [x] Admin-only route protection via middleware

[x] 4.2 Admin Dashboard (/admin)
    - [x] Overview stats cards (Total Cases, Active, Leads, Reviews)
    - [x] Recent activities feed
    - [x] System health monitor widget

[x] 4.3 Tickets Management (/admin/tickets)
    - [x] Global tickets list with powerful filters
    - [x] User-to-case mapping and status badges

[x] 4.4 Ticket Detail (/admin/tickets/[id])
    - [x] Administrative controls (Stage, Status, Progress)
    - [x] Full Interaction Hub (Chat, Timeline logs)
    - [x] Document review and download flow

[x] 4.5 Callbacks Management (/admin/callbacks)
    - [x] Responsive leads management table
    - [x] Status processing (New -> Contacted -> Converted)

[x] 4.6 Reviews Moderation (/admin/reviews)
    - [x] Review grid with star ratings
    - [x] One-click approval/rejection moderation

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

## Phase 5: Integration & Polish
Status: [ ] NOT STARTED

[ ] 5.1 Connect Public Forms
    - [ ] Update callback form â†’ POST /api/callbacks
    - [ ] Update review form â†’ POST /api/reviews
    - [ ] Display approved reviews from database

[ ] 5.2 File Storage
    - [ ] Implement local file storage (dev)
    - [ ] Document upload flow
    - [ ] Signed URL generation

[ ] 5.3 Testing & Polish
    - [ ] Test all API endpoints
    - [ ] Test auth flows
    - [ ] Test portal user journey
    - [ ] Test admin workflows
    - [ ] Mobile responsiveness check

[ ] 5.4 Documentation
    - [ ] Update README with setup steps
    - [ ] Document environment variables
    - [ ] Document deployment process

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

## Phase 6: AWS Deployment (Future)
Status: [ ] NOT STARTED

[ ] 6.1 AWS RDS PostgreSQL
    - [ ] Create RDS instance
    - [ ] Update DATABASE_URL
    - [ ] Run migrations on production

[ ] 6.2 AWS S3
    - [ ] Create S3 bucket
    - [ ] Configure CORS
    - [ ] Update file upload to use S3
    - [ ] Implement signed URLs

[ ] 6.3 Production Deployment
    - [ ] Deploy to AWS (EC2/ECS/Amplify)
    - [ ] Configure environment variables
    - [ ] Setup domain and SSL
    - [ ] Test production deployment

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                            TECHNICAL SPECIFICATIONS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## Tech Stack

| Component       | Technology                              |
|-----------------|----------------------------------------|
| Framework       | Next.js 14 App Router                  |
| Language        | TypeScript                             |
| Styling         | Tailwind CSS + shadcn/ui               |
| Charts          | Chart.js via react-chartjs-2          |
| Auth            | NextAuth.js (Google + Email OTP ready) |
| Database        | PostgreSQL (local â†’ AWS RDS)          |
| ORM             | Prisma                                 |
| File Storage    | Local â†’ AWS S3                         |
| State           | TanStack Query (existing)              |

## Environment Variables Required

```env
# Database
DATABASE_URL="postgresql://user:password@localhost:5432/fairpay"

# NextAuth
NEXTAUTH_URL="http://localhost:3000"
NEXTAUTH_SECRET="your-secret-key-here"

# Google OAuth
GOOGLE_CLIENT_ID="your-google-client-id"
GOOGLE_CLIENT_SECRET="your-google-client-secret"

# AWS S3 (Phase 6)
AWS_ACCESS_KEY_ID=""
AWS_SECRET_ACCESS_KEY=""
AWS_REGION=""
AWS_S3_BUCKET=""
```

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                              FOLDER STRUCTURE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

```
fairpay-solution/
â”œâ”€â”€ app/                              # Next.js App Router
â”‚   â”œâ”€â”€ (marketing)/                  # Public marketing pages
â”‚   â”‚   â”œâ”€â”€ page.tsx                  # Home page (/)
â”‚   â”‚   â”œâ”€â”€ calculator/page.tsx
â”‚   â”‚   â”œâ”€â”€ how-it-works/page.tsx
â”‚   â”‚   â”œâ”€â”€ eligibility/page.tsx
â”‚   â”‚   â”œâ”€â”€ contact/page.tsx
â”‚   â”‚   â”œâ”€â”€ media/page.tsx
â”‚   â”‚   â”œâ”€â”€ privacy/page.tsx
â”‚   â”‚   â”œâ”€â”€ terms/page.tsx
â”‚   â”‚   â”œâ”€â”€ disclaimer/page.tsx
â”‚   â”‚   â”œâ”€â”€ loan-policy/page.tsx
â”‚   â”‚   â”œâ”€â”€ no-guarantee/page.tsx
â”‚   â”‚   â”œâ”€â”€ fees-refund/page.tsx
â”‚   â”‚   â””â”€â”€ layout.tsx                # Marketing layout (Navbar + Footer)
â”‚   â”‚
â”‚   â”œâ”€â”€ portal/                       # Client Portal (protected)
â”‚   â”‚   â”œâ”€â”€ page.tsx                  # Dashboard with progress chart
â”‚   â”‚   â”œâ”€â”€ tickets/
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx              # Ticket list
â”‚   â”‚   â”‚   â””â”€â”€ [id]/page.tsx         # Ticket detail
â”‚   â”‚   â””â”€â”€ layout.tsx                # Portal sidebar layout
â”‚   â”‚
â”‚   â”œâ”€â”€ admin/                        # Admin Dashboard (ADMIN only)
â”‚   â”‚   â”œâ”€â”€ page.tsx                  # Overview
â”‚   â”‚   â”œâ”€â”€ tickets/
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx              # All tickets
â”‚   â”‚   â”‚   â””â”€â”€ [id]/page.tsx         # Ticket management
â”‚   â”‚   â”œâ”€â”€ callbacks/page.tsx        # Callback requests
â”‚   â”‚   â”œâ”€â”€ reviews/page.tsx          # Review moderation
â”‚   â”‚   â””â”€â”€ layout.tsx                # Admin sidebar
â”‚   â”‚
â”‚   â”œâ”€â”€ api/                          # API Route Handlers
â”‚   â”‚   â”œâ”€â”€ auth/[...nextauth]/route.ts
â”‚   â”‚   â”œâ”€â”€ tickets/
â”‚   â”‚   â”‚   â”œâ”€â”€ route.ts
â”‚   â”‚   â”‚   â””â”€â”€ [id]/
â”‚   â”‚   â”‚       â”œâ”€â”€ route.ts
â”‚   â”‚   â”‚       â”œâ”€â”€ events/route.ts
â”‚   â”‚   â”‚       â”œâ”€â”€ documents/route.ts
â”‚   â”‚   â”‚       â””â”€â”€ messages/route.ts
â”‚   â”‚   â”œâ”€â”€ documents/[id]/route.ts
â”‚   â”‚   â”œâ”€â”€ callbacks/
â”‚   â”‚   â”‚   â”œâ”€â”€ route.ts
â”‚   â”‚   â”‚   â””â”€â”€ [id]/route.ts
â”‚   â”‚   â””â”€â”€ reviews/
â”‚   â”‚       â”œâ”€â”€ route.ts
â”‚   â”‚       â””â”€â”€ [id]/route.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ layout.tsx                    # Root layout
â”‚   â”œâ”€â”€ globals.css                   # Global styles
â”‚   â””â”€â”€ providers.tsx                 # Context providers
â”‚
â”œâ”€â”€ components/                       # Shared components
â”‚   â”œâ”€â”€ ui/                           # shadcn/ui (existing)
â”‚   â”œâ”€â”€ home/                         # Marketing (existing)
â”‚   â”œâ”€â”€ layout/                       # Header, Footer (existing)
â”‚   â”œâ”€â”€ portal/                       # Client portal (NEW)
â”‚   â”‚   â”œâ”€â”€ ProgressChart.tsx
â”‚   â”‚   â”œâ”€â”€ TicketCard.tsx
â”‚   â”‚   â”œâ”€â”€ Timeline.tsx
â”‚   â”‚   â”œâ”€â”€ DocumentUpload.tsx
â”‚   â”‚   â””â”€â”€ ChatWindow.tsx
â”‚   â””â”€â”€ admin/                        # Admin (NEW)
â”‚       â”œâ”€â”€ TicketsTable.tsx
â”‚       â”œâ”€â”€ ProgressEditor.tsx
â”‚       â”œâ”€â”€ CallbacksTable.tsx
â”‚       â””â”€â”€ ReviewsTable.tsx
â”‚
â”œâ”€â”€ lib/                              # Utilities
â”‚   â”œâ”€â”€ prisma.ts                     # Prisma client
â”‚   â”œâ”€â”€ auth.ts                       # NextAuth config
â”‚   â”œâ”€â”€ utils.ts                      # Existing utils
â”‚   â””â”€â”€ s3.ts                         # S3 helpers (stub)
â”‚
â”œâ”€â”€ prisma/
â”‚   â”œâ”€â”€ schema.prisma                 # Database schema
â”‚   â””â”€â”€ seed.ts                       # Seed admin users
â”‚
â”œâ”€â”€ public/                           # Static assets
â”œâ”€â”€ middleware.ts                     # Route protection
â”œâ”€â”€ next.config.js
â”œâ”€â”€ tailwind.config.ts
â””â”€â”€ package.json
```

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                              PRISMA SCHEMA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

```prisma
// prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â• AUTH & USERS â•â•â•â•â•â•â•â•â•â•â•â•â•â•

model Account {
  id                String  @id @default(cuid())
  userId            String
  type              String
  provider          String
  providerAccountId String
  refresh_token     String? @db.Text
  access_token      String? @db.Text
  expires_at        Int?
  token_type        String?
  scope             String?
  id_token          String? @db.Text
  session_state     String?
  user              User    @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([provider, providerAccountId])
}

model Session {
  id           String   @id @default(cuid())
  sessionToken String   @unique
  userId       String
  expires      DateTime
  user         User     @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model User {
  id            String    @id @default(cuid())
  name          String?
  email         String?   @unique
  emailVerified DateTime?
  image         String?
  phone         String?
  role          Role      @default(USER)
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt

  accounts         Account[]
  sessions         Session[]
  tickets          Ticket[]
  chatMessages     ChatMessage[]
  ticketEvents     TicketEvent[]     @relation("CreatedByAdmin")
  reviewedDocs     Document[]        @relation("ReviewedByAdmin")
  handledCallbacks CallbackRequest[] @relation("HandledByAdmin")
  approvedReviews  Review[]          @relation("ApprovedByAdmin")
}

model VerificationToken {
  identifier String
  token      String   @unique
  expires    DateTime

  @@unique([identifier, token])
}

enum Role {
  USER
  ADMIN
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â• TICKETS (LOAN CASES) â•â•â•â•â•â•â•â•â•â•â•â•â•â•

model Ticket {
  id             String       @id @default(cuid())
  userId         String
  user           User         @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  loanType       String       // "Personal Loan", "Credit Card", etc.
  lenderName     String?      // Bank/NBFC name
  loanAmount     Float?       // Outstanding amount
  
  stage          Stage        @default(ASSESSMENT)
  stagePercent   Int          @default(0)  // 0-100
  overallPercent Int          @default(0)  // 0-100
  status         TicketStatus @default(OPEN)
  
  settledAmount  Float?       // Final negotiated loan amount
  settledAt      DateTime?    // When settlement was recorded

  createdAt      DateTime     @default(now())
  updatedAt      DateTime     @updatedAt

  events         TicketEvent[]
  documents      Document[]
  messages       ChatMessage[]
}

enum Stage {
  ASSESSMENT
  REVIEW
  STRATEGY
  NEGOTIATION
  SETTLEMENT
  CLOSED
  REJECTED
}

enum TicketStatus {
  OPEN
  ON_HOLD
  COMPLETED
  CANCELLED
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â• TICKET EVENTS (TIMELINE) â•â•â•â•â•â•â•â•â•â•â•â•â•â•

model TicketEvent {
  id          String      @id @default(cuid())
  ticketId    String
  ticket      Ticket      @relation(fields: [ticketId], references: [id], onDelete: Cascade)
  
  type        EventType
  message     String      // Human-readable update
  
  createdAt   DateTime    @default(now())
  createdById String?
  createdBy   User?       @relation("CreatedByAdmin", fields: [createdById], references: [id])
}

enum EventType {
  INFO
  DOCUMENT
  STATUS_CHANGE
  STAGE_CHANGE
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â• DOCUMENTS â•â•â•â•â•â•â•â•â•â•â•â•â•â•

model Document {
  id              String         @id @default(cuid())
  ticketId        String
  ticket          Ticket         @relation(fields: [ticketId], references: [id], onDelete: Cascade)
  
  name            String         // "PAN Card", "Salary Slip"
  fileUrl         String
  mimeType        String?
  fileSize        Int?
  
  status          DocumentStatus @default(PENDING)
  rejectionReason String?
  
  uploadedAt      DateTime       @default(now())
  reviewedAt      DateTime?
  reviewedById    String?
  reviewedBy      User?          @relation("ReviewedByAdmin", fields: [reviewedById], references: [id])
}

enum DocumentStatus {
  PENDING
  APPROVED
  REJECTED
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â• CHAT MESSAGES â•â•â•â•â•â•â•â•â•â•â•â•â•â•

model ChatMessage {
  id         String   @id @default(cuid())
  ticketId   String
  ticket     Ticket   @relation(fields: [ticketId], references: [id], onDelete: Cascade)
  
  senderId   String
  sender     User     @relation(fields: [senderId], references: [id])
  senderRole Role
  content    String   @db.Text
  
  createdAt  DateTime @default(now())
  readAt     DateTime?
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â• CALLBACK REQUESTS (LEADS) â•â•â•â•â•â•â•â•â•â•â•â•â•â•

model CallbackRequest {
  id               String         @id @default(cuid())
  name             String
  phone            String
  email            String?
  city             String?
  preferredTime    String?
  source           String         @default("website")
  
  status           CallbackStatus @default(NEW)
  notes            String?        @db.Text
  
  createdAt        DateTime       @default(now())
  handledByAdminId String?
  handledByAdmin   User?          @relation("HandledByAdmin", fields: [handledByAdminId], references: [id])
}

enum CallbackStatus {
  NEW
  CALLED
  NO_ANSWER
  QUALIFIED
  DISQUALIFIED
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â• REVIEWS â•â•â•â•â•â•â•â•â•â•â•â•â•â•

model Review {
  id                String   @id @default(cuid())
  rating            Int      // 1-5
  name              String
  location          String?
  text              String   @db.Text
  
  approved          Boolean  @default(false)
  createdAt         DateTime @default(now())
  approvedAt        DateTime?
  approvedByAdminId String?
  approvedByAdmin   User?    @relation("ApprovedByAdmin", fields: [approvedByAdminId], references: [id])
}
```

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                              API ENDPOINTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

| Method | Endpoint                        | Access     | Description                             |
|--------|--------------------------------|------------|----------------------------------------|
| AUTH   |                                |            |                                        |
| *      | /api/auth/*                    | Public     | NextAuth routes                        |
|        |                                |            |                                        |
| TICKETS|                                |            |                                        |
| GET    | /api/tickets                   | USER/ADMIN | List tickets                           |
| POST   | /api/tickets                   | USER       | Create new ticket                      |
| GET    | /api/tickets/[id]              | Owner/ADMIN| Get ticket detail                      |
| PATCH  | /api/tickets/[id]              | ADMIN      | Update stage/status                    |
| POST   | /api/tickets/[id]/events       | ADMIN      | Add timeline event                     |
| POST   | /api/tickets/[id]/documents    | USER       | Upload document                        |
| GET    | /api/tickets/[id]/messages     | Owner/ADMIN| Get chat messages                      |
| POST   | /api/tickets/[id]/messages     | Owner/ADMIN| Send message                           |
|        |                                |            |                                        |
| DOCS   |                                |            |                                        |
| PATCH  | /api/documents/[id]            | ADMIN      | Approve/reject document                |
|        |                                |            |                                        |
| CALLBACKS|                              |            |                                        |
| POST   | /api/callbacks                 | Public     | Submit callback request                |
| GET    | /api/callbacks                 | ADMIN      | List all callbacks                     |
| PATCH  | /api/callbacks/[id]            | ADMIN      | Update status/notes                    |
|        |                                |            |                                        |
| REVIEWS|                                |            |                                        |
| POST   | /api/reviews                   | Public     | Submit review                          |
| GET    | /api/reviews                   | Public     | Get approved reviews                   |
| PATCH  | /api/reviews/[id]              | ADMIN      | Approve/reject review                  |

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                           BUSINESS LOGIC NOTES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## 5-Stage Loan Journey

1. ASSESSMENT  - Free initial consultation, intake, basic info, documents
2. REVIEW      - Case review, eligibility, risk, checking lender options
3. STRATEGY    - Structured repayment/settlement strategy design
4. NEGOTIATION - Active negotiation with lenders, offers/counter-offers
5. SETTLEMENT  - Final settlement/closure guidance, post-settlement advisory

## Overall Progress Calculation

Formula: overallPercent = (stageIndex Ã— 20) + (stagePercent / 5)

Where stageIndex is:
- ASSESSMENT  = 0
- REVIEW      = 1
- STRATEGY    = 2
- NEGOTIATION = 3
- SETTLEMENT  = 4

Examples:
- ASSESSMENT at 50% = (0 Ã— 20) + (50 / 5) = 10%
- REVIEW at 100%    = (1 Ã— 20) + (100 / 5) = 40%
- STRATEGY at 50%   = (2 Ã— 20) + (50 / 5) = 50%
- SETTLEMENT at 100%= (4 Ã— 20) + (100 / 5) = 100%

## Auto-Generated Timeline Events

When admin changes stage/status, auto-create TicketEvent:
- Stage change: "Your case has moved to [STAGE_NAME]. [Stage description]"
- Status change: "Case status updated to [STATUS]."
- Document approved: "Your [DOC_NAME] has been verified successfully."
- Document rejected: "Your [DOC_NAME] needs revision: [reason]"

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                              UI WIREFRAMES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## Client Portal - Ticket Detail (/portal/tickets/[id])

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“‹ Portal > Tickets > Personal Loan #TK-2024-001                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  ğŸ¦ Personal Loan - HDFC Bank        [OPEN] â—                           â”‚ â”‚
â”‚  â”‚  â‚¹3,50,000 Outstanding                                                  â”‚ â”‚
â”‚  â”‚                                                                         â”‚ â”‚
â”‚  â”‚  [â—] Assessment  [â—] Review  [â—] Strategy  [ ] Negotiation  [ ] Settle  â”‚ â”‚
â”‚  â”‚                                                                         â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   Overall Progress: 45%                                â”‚ â”‚
â”‚  â”‚  â”‚   45%      â”‚   "We're preparing your settlement strategy."          â”‚ â”‚
â”‚  â”‚  â”‚  ğŸ© CHART  â”‚   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘                       â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚        ğŸ“œ TIMELINE            â”‚  â”‚  [Documents] [ğŸ’¬ Chat]              â”‚ â”‚
â”‚  â”‚                               â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚  â— 18 Jan - Strategy begun    â”‚  â”‚  ğŸ“„ PAN Card        [âœ“ Approved]   â”‚ â”‚
â”‚  â”‚  â— 15 Jan - Doc approved      â”‚  â”‚  ğŸ“„ Salary Slip     [â³ Pending]    â”‚ â”‚
â”‚  â”‚  â— 12 Jan - Review complete   â”‚  â”‚  ğŸ“„ Bank Statement  [âœ— Rejected]   â”‚ â”‚
â”‚  â”‚  â— 10 Jan - Case opened       â”‚  â”‚                                     â”‚ â”‚
â”‚  â”‚                               â”‚  â”‚  [ğŸ“¤ Upload Document]               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

## Admin Dashboard - Ticket Management (/admin/tickets/[id])

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  Admin > Tickets > TK-2024-001                                  â”‚
â”‚ â”‚ ğŸ  Home  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚ â”‚ ğŸ“‹ Ticketsâ”‚                                                                â”‚
â”‚ â”‚ ğŸ“ Leads â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ â­ Reviewsâ”‚  â”‚  ğŸ‘¤ Rajesh Kumar | Personal Loan | â‚¹3,50,000  [Save]      â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                                                            â”‚â”‚
â”‚               â”‚  Stage:   [â–¼ STRATEGY    ]   Stage %: [====â—====] 45%      â”‚â”‚
â”‚               â”‚  Status:  [â–¼ OPEN        ]   Overall:  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘ 45%     â”‚â”‚
â”‚               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  ğŸ“ TIMELINE EDITOR            â”‚  â”‚  ğŸ“ DOCUMENTS                       â”‚â”‚
â”‚  â”‚  [Enter update...] [+ Add]     â”‚  â”‚  PAN Card     âœ“ Approved   [View]  â”‚â”‚
â”‚  â”‚                                â”‚  â”‚  Salary Slip  â³ Pending   [âœ“] [âœ—] â”‚â”‚
â”‚  â”‚  â— 18 Jan - Strategy started   â”‚  â”‚  Bank Stmt    âœ— Rejected   [View]  â”‚â”‚
â”‚  â”‚  â— 15 Jan - Doc approved       â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚  â”‚  â— 12 Jan - Review complete    â”‚                                         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚                                      â”‚  ğŸ’¬ CHAT                             â”‚â”‚
â”‚                                      â”‚  User: Can you update me?           â”‚â”‚
â”‚                                      â”‚  You: Working on strategy now       â”‚â”‚
â”‚                                      â”‚  [Type reply...            ] [Send] â”‚â”‚
â”‚                                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                           EXISTING PAGES TO MIGRATE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Current Vite Routes â†’ Next.js App Router Routes:

| Current Route     | Next.js Route                    | Status      |
|------------------|----------------------------------|-------------|
| /                | app/(marketing)/page.tsx         | [ ] Pending |
| /calculator      | app/(marketing)/calculator/      | [ ] Pending |
| /how-it-works    | app/(marketing)/how-it-works/    | [ ] Pending |
| /eligibility     | app/(marketing)/eligibility/     | [ ] Pending |
| /contact         | app/(marketing)/contact/         | [ ] Pending |
| /media           | app/(marketing)/media/           | [ ] Pending |
| /privacy         | app/(marketing)/privacy/         | [ ] Pending |
| /terms           | app/(marketing)/terms/           | [ ] Pending |
| /disclaimer      | app/(marketing)/disclaimer/      | [ ] Pending |
| /loan-policy     | app/(marketing)/loan-policy/     | [ ] Pending |
| /no-guarantee    | app/(marketing)/no-guarantee/    | [ ] Pending |
| /fees-refund     | app/(marketing)/fees-refund/     | [ ] Pending |
| /dashboard       | (Remove - replaced by /portal)   | [ ] Pending |
| /vault           | (Review if needed)               | [ ] Pending |

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                              COMPLIANCE NOTES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

From existing site - MUST maintain:

âœ“ "We are not a bank, NBFC, or lender. Consultancy services only."
âœ“ Clear disclaimers on all advisory-related pages
âœ“ "Know Your Rights" orientation
âœ“ "No Guarantee" policy - don't promise settlement outcomes
âœ“ "Fees & Refund" policy in content structure
âœ“ RBI-compliant, ethical, advisory-only positioning
âœ“ Transparent, reassuring, rights-aware messaging tone

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                              SETUP INSTRUCTIONS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## Prerequisites

1. Node.js 18+ installed
2. PostgreSQL installed locally (or use Docker)
3. Google Cloud Console account (for OAuth)

## Google OAuth Setup (Step-by-Step)

1. Go to https://console.cloud.google.com/
2. Create new project or select existing
3. Go to "APIs & Services" > "Credentials"
4. Click "Create Credentials" > "OAuth client ID"
5. Configure consent screen if prompted
6. Application type: "Web application"
7. Authorized redirect URIs:
   - http://localhost:3000/api/auth/callback/google (dev)
   - https://yourdomain.com/api/auth/callback/google (prod)
8. Copy Client ID and Client Secret to .env

## Local PostgreSQL Setup

Option A: Install PostgreSQL directly
Option B: Use Docker:
```bash
docker run --name fairpay-postgres -e POSTGRES_PASSWORD=password -e POSTGRES_DB=fairpay -p 5432:5432 -d postgres
```

## Initial Setup Commands

```bash
# Install dependencies
npm install

# Setup Prisma
npx prisma generate
npx prisma db push

# Seed admin user
npx prisma db seed

# Run development server
npm run dev
```

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                                CHANGE LOG
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

2026-01-18 10:12 - Initial roadmap created
                 - Defined full spec, folder structure, Prisma schema
                 - Created progress tracker for all phases
                 - Documented API endpoints and UI wireframes

2026-01-18 11:20 - PHASE 1 COMPLETED âœ…
                 - Migrated from Vite to Next.js 14 App Router
                 - All react-router-dom replaced with next/link
                 - Created app/(marketing)/ with layout and home page
                 - Setup PostgreSQL via Docker container (fairpay-postgres)
                 - Ran `prisma db push` - all 12 tables created
                 - Seeded database: 2 admin users, 5 sample reviews
                 - Configured Google OAuth credentials in .env.local
                 - NextAuth configured with role-based access
                 - Middleware protecting /portal and /admin routes
                 - API routes working: /api/reviews, /api/callbacks
                 - Homepage now fetches reviews from PostgreSQL âœ“

2026-01-18 13:06 - PHASE 2 & 3 PROGRESS (Transition from Claude to Antigravity)
                 - Built Client Portal Layout with Navigation
                 - Created Portal Dashboard with dynamic stats
                 - Developed My Tickets list and New Ticket Form flow
                 - Implemented full Ticket API suite (/api/tickets and /api/tickets/[id])
                 - Implemented Chat Message and Ticket Event APIs
                 - Fixed Prisma schema mismatches in API routes
                 - Created professional Auth Sign-in page with Google integration
                 - Verified portal shell rendering and 401 protection

2026-01-18 13:45 - PHASE 3 & 4 COMPLETED âœ… (Platform Full Integration)
                 - COMPLETED CLIENT PORTAL: Added Ticket Detail with Chat, Timeline, and Docs.
                 - ADDED Documents Page and Profile Page to the portal.
                 - COMPLETED ADMIN COMMAND CENTER: Built /admin layout and dashboard.
                 - IMPLEMENTED Admin Ticket Management: Global list and Case Control Panel.
                 - IMPLEMENTED Lead Management: Callback tracking CRM and status processing.
                 - IMPLEMENTED Review Moderation: One-click approval system for testimonials.
                 - DATABASE MIGRATION: Added loanAmount/loanType to CallbackRequest model.
                 - FINAL INTEGRATION: Connected public forms (Contact/Popups) to PostgreSQL.
                 - SEO & PWA: Created manifest.json and optimized metadata.
                 - DOCUMENTATION: Fully overhauled README.md for the new architecture.

2026-01-19 14:20 - DOCUMENT PERSISTENCE & LIFECYCLE REFINEMENT âœ…
                 - STORAGE ARCHITECTURE: Introduced `StorageProvider` (lib/storage.ts) for local vs S3 flexibility.
                 - DOCUMENT UPLOAD FIX: Resolved "Invalid time value" crashes; switched logic to use `uploadedAt`.
                 - LIFECYCLE ENHANCEMENT: Added `CLOSED` and `REJECTED` terminal stages to PostgreSQL schema.
                 - SETTLEMENT LOGIC: Added `settledAmount` tracking and "Settlement Reached!" UI for clients.
                 - ADVISOR CONTROLS: Added dedicated "Resolve Case" and "Reject Case" buttons for one-click closure.
                 - ADMIN FIXES: Created missing /admin/users/[id] detail page to fix 404 errors in dashboard.
                 - PROGRESS MATH: Updated overall progress logic to handle terminal states at 100%.
                 - API STABILITY: Fixed PATCH response consistency to prevent frontend state crashes.

2026-01-19 16:30 - END-TO-END LIFECYCLE VERIFICATION âœ… (Live Browser Testing)
                 - AUTOMATED TESTING: Implemented temporary CredentialsProvider for browser automation.
                 - USER FLOW VERIFIED: Created "mpoket" ticket (â‚¹2,00,000) as jayeshsinghwork@gmail.com.
                   â€¢ Document upload successful with correct `uploadedAt` formatting (19 Jan 2026).
                   â€¢ Initial progress correctly shown at 0% in Assessment stage.
                 - ADMIN FLOW VERIFIED: Managed ticket as hsinghjayesh@gmail.com.
                   â€¢ User profile navigation (no 404 errors).
                   â€¢ Message communication working bidirectionally.
                   â€¢ Settlement amount input (â‚¹1,00,000) recorded correctly.
                   â€¢ "Resolve Case" button successfully closed ticket.
                 - CLIENT SUCCESS VERIFIED: Returned to user portal.
                   â€¢ "Settlement Reached!" alert displayed prominently.
                   â€¢ All progress stages marked complete (100%).
                   â€¢ Final stage correctly shown as "Closed".
                 - CLEANUP: Removed temporary authentication bypass, restored production OAuth.
                 - RESULT: Full ticket lifecycle verified working end-to-end with visual evidence.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#                              END OF DOCUMENT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•