(()=>{var pi=Object.create;var It=Object.defineProperty;var mi=Object.getOwnPropertyDescriptor;var fi=Object.getOwnPropertyNames;var hi=Object.getPrototypeOf,gi=Object.prototype.hasOwnProperty;var bi=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports);var yi=(r,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of fi(e))!gi.call(r,n)&&n!==t&&It(r,n,{get:()=>e[n],enumerable:!(i=mi(e,n))||i.enumerable});return r};var wi=(r,e,t)=>(t=r!=null?pi(hi(r)):{},yi(e||!r||!r.__esModule?It(t,"default",{value:r,enumerable:!0}):t,r));var di=bi((Oe,he)=>{var Yi=200,qr="__lodash_hash_undefined__",Ji=800,Zi=16,Hr=9007199254740991,Gr="[object Arguments]",Qi="[object Array]",Xi="[object AsyncFunction]",en="[object Boolean]",tn="[object Date]",rn="[object Error]",zr="[object Function]",nn="[object GeneratorFunction]",sn="[object Map]",on="[object Number]",an="[object Null]",Kr="[object Object]",cn="[object Proxy]",ln="[object RegExp]",un="[object Set]",dn="[object String]",pn="[object Undefined]",mn="[object WeakMap]",fn="[object ArrayBuffer]",hn="[object DataView]",gn="[object Float32Array]",bn="[object Float64Array]",yn="[object Int8Array]",wn="[object Int16Array]",vn="[object Int32Array]",_n="[object Uint8Array]",Sn="[object Uint8ClampedArray]",En="[object Uint16Array]",kn="[object Uint32Array]",xn=/[\\^$.*+?()[\]{}|]/g,Cn=/^\[object .+?Constructor\]$/,In=/^(?:0|[1-9]\d*)$/,C={};C[gn]=C[bn]=C[yn]=C[wn]=C[vn]=C[_n]=C[Sn]=C[En]=C[kn]=!0;C[Gr]=C[Qi]=C[fn]=C[en]=C[hn]=C[tn]=C[rn]=C[zr]=C[sn]=C[on]=C[Kr]=C[ln]=C[un]=C[dn]=C[mn]=!1;var Yr=typeof global=="object"&&global&&global.Object===Object&&global,Rn=typeof self=="object"&&self&&self.Object===Object&&self,$e=Yr||Rn||Function("return this")(),Jr=typeof Oe=="object"&&Oe&&!Oe.nodeType&&Oe,Me=Jr&&typeof he=="object"&&he&&!he.nodeType&&he,Zr=Me&&Me.exports===Jr,ft=Zr&&Yr.process,Mr=function(){try{var r=Me&&Me.require&&Me.require("util").types;return r||ft&&ft.binding&&ft.binding("util")}catch{}}(),Dr=Mr&&Mr.isTypedArray;function Qr(r,e,t){switch(t.length){case 0:return r.call(e);case 1:return r.call(e,t[0]);case 2:return r.call(e,t[0],t[1]);case 3:return r.call(e,t[0],t[1],t[2])}return r.apply(e,t)}function Pn(r,e){for(var t=-1,i=Array(r);++t<r;)i[t]=e(t);return i}function Tn(r){return function(e){return r(e)}}function Ln(r,e){return r?.[e]}function Un(r,e){return function(t){return r(e(t))}}var An=Array.prototype,On=Function.prototype,rt=Object.prototype,ht=$e["__core-js_shared__"],it=On.toString,re=rt.hasOwnProperty,$r=function(){var r=/[^.]+$/.exec(ht&&ht.keys&&ht.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}(),Xr=rt.toString,Mn=it.call(Object),Dn=RegExp("^"+it.call(re).replace(xn,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),et=Zr?$e.Buffer:void 0,Fr=$e.Symbol,Br=$e.Uint8Array,jr=et?et.allocUnsafe:void 0,ei=Un(Object.getPrototypeOf,Object),Vr=Object.create,$n=rt.propertyIsEnumerable,Fn=An.splice,ue=Fr?Fr.toStringTag:void 0,tt=function(){try{var r=St(Object,"defineProperty");return r({},"",{}),r}catch{}}(),Bn=et?et.isBuffer:void 0,Wr=Math.max,jn=Date.now,ti=St($e,"Map"),De=St(Object,"create"),Vn=function(){function r(){}return function(e){if(!te(e))return{};if(Vr)return Vr(e);r.prototype=e;var t=new r;return r.prototype=void 0,t}}();function de(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var i=r[e];this.set(i[0],i[1])}}function Wn(){this.__data__=De?De(null):{},this.size=0}function Nn(r){var e=this.has(r)&&delete this.__data__[r];return this.size-=e?1:0,e}function qn(r){var e=this.__data__;if(De){var t=e[r];return t===qr?void 0:t}return re.call(e,r)?e[r]:void 0}function Hn(r){var e=this.__data__;return De?e[r]!==void 0:re.call(e,r)}function Gn(r,e){var t=this.__data__;return this.size+=this.has(r)?0:1,t[r]=De&&e===void 0?qr:e,this}de.prototype.clear=Wn;de.prototype.delete=Nn;de.prototype.get=qn;de.prototype.has=Hn;de.prototype.set=Gn;function ie(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var i=r[e];this.set(i[0],i[1])}}function zn(){this.__data__=[],this.size=0}function Kn(r){var e=this.__data__,t=nt(e,r);if(t<0)return!1;var i=e.length-1;return t==i?e.pop():Fn.call(e,t,1),--this.size,!0}function Yn(r){var e=this.__data__,t=nt(e,r);return t<0?void 0:e[t][1]}function Jn(r){return nt(this.__data__,r)>-1}function Zn(r,e){var t=this.__data__,i=nt(t,r);return i<0?(++this.size,t.push([r,e])):t[i][1]=e,this}ie.prototype.clear=zn;ie.prototype.delete=Kn;ie.prototype.get=Yn;ie.prototype.has=Jn;ie.prototype.set=Zn;function ge(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var i=r[e];this.set(i[0],i[1])}}function Qn(){this.size=0,this.__data__={hash:new de,map:new(ti||ie),string:new de}}function Xn(r){var e=ot(this,r).delete(r);return this.size-=e?1:0,e}function es(r){return ot(this,r).get(r)}function ts(r){return ot(this,r).has(r)}function rs(r,e){var t=ot(this,r),i=t.size;return t.set(r,e),this.size+=t.size==i?0:1,this}ge.prototype.clear=Qn;ge.prototype.delete=Xn;ge.prototype.get=es;ge.prototype.has=ts;ge.prototype.set=rs;function be(r){var e=this.__data__=new ie(r);this.size=e.size}function is(){this.__data__=new ie,this.size=0}function ns(r){var e=this.__data__,t=e.delete(r);return this.size=e.size,t}function ss(r){return this.__data__.get(r)}function os(r){return this.__data__.has(r)}function as(r,e){var t=this.__data__;if(t instanceof ie){var i=t.__data__;if(!ti||i.length<Yi-1)return i.push([r,e]),this.size=++t.size,this;t=this.__data__=new ge(i)}return t.set(r,e),this.size=t.size,this}be.prototype.clear=is;be.prototype.delete=ns;be.prototype.get=ss;be.prototype.has=os;be.prototype.set=as;function cs(r,e){var t=wt(r),i=!t&&yt(r),n=!t&&!i&&oi(r),o=!t&&!i&&!n&&ci(r),s=t||i||n||o,a=s?Pn(r.length,String):[],u=a.length;for(var c in r)(e||re.call(r,c))&&!(s&&(c=="length"||n&&(c=="offset"||c=="parent")||o&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||ni(c,u)))&&a.push(c);return a}function gt(r,e,t){(t!==void 0&&!at(r[e],t)||t===void 0&&!(e in r))&&vt(r,e,t)}function ls(r,e,t){var i=r[e];(!(re.call(r,e)&&at(i,t))||t===void 0&&!(e in r))&&vt(r,e,t)}function nt(r,e){for(var t=r.length;t--;)if(at(r[t][0],e))return t;return-1}function vt(r,e,t){e=="__proto__"&&tt?tt(r,e,{configurable:!0,enumerable:!0,value:t,writable:!0}):r[e]=t}var us=Ss();function st(r){return r==null?r===void 0?pn:an:ue&&ue in Object(r)?Es(r):Ps(r)}function Nr(r){return Fe(r)&&st(r)==Gr}function ds(r){if(!te(r)||Is(r))return!1;var e=kt(r)?Dn:Cn;return e.test(As(r))}function ps(r){return Fe(r)&&ai(r.length)&&!!C[st(r)]}function ms(r){if(!te(r))return Rs(r);var e=si(r),t=[];for(var i in r)i=="constructor"&&(e||!re.call(r,i))||t.push(i);return t}function _t(r,e,t,i,n){r!==e&&us(e,function(o,s){if(n||(n=new be),te(o))fs(r,e,s,t,_t,i,n);else{var a=i?i(bt(r,s),o,s+"",r,e,n):void 0;a===void 0&&(a=o),gt(r,s,a)}},li)}function fs(r,e,t,i,n,o,s){var a=bt(r,t),u=bt(e,t),c=s.get(u);if(c){gt(r,t,c);return}var l=o?o(a,u,t+"",r,e,s):void 0,d=l===void 0;if(d){var f=wt(u),g=!f&&oi(u),h=!f&&!g&&ci(u);l=u,f||g||h?wt(a)?l=a:Os(a)?l=ws(a):g?(d=!1,l=gs(u,!0)):h?(d=!1,l=ys(u,!0)):l=[]:Ms(u)||yt(u)?(l=a,yt(a)?l=Ds(a):(!te(a)||kt(a))&&(l=ks(u))):d=!1}d&&(s.set(u,l),n(l,u,i,o,s),s.delete(u)),gt(r,t,l)}function ri(r,e){return Ls(Ts(r,e,ui),r+"")}var hs=tt?function(r,e){return tt(r,"toString",{configurable:!0,enumerable:!1,value:Bs(e),writable:!0})}:ui;function gs(r,e){if(e)return r.slice();var t=r.length,i=jr?jr(t):new r.constructor(t);return r.copy(i),i}function bs(r){var e=new r.constructor(r.byteLength);return new Br(e).set(new Br(r)),e}function ys(r,e){var t=e?bs(r.buffer):r.buffer;return new r.constructor(t,r.byteOffset,r.length)}function ws(r,e){var t=-1,i=r.length;for(e||(e=Array(i));++t<i;)e[t]=r[t];return e}function vs(r,e,t,i){var n=!t;t||(t={});for(var o=-1,s=e.length;++o<s;){var a=e[o],u=i?i(t[a],r[a],a,t,r):void 0;u===void 0&&(u=r[a]),n?vt(t,a,u):ls(t,a,u)}return t}function _s(r){return ri(function(e,t){var i=-1,n=t.length,o=n>1?t[n-1]:void 0,s=n>2?t[2]:void 0;for(o=r.length>3&&typeof o=="function"?(n--,o):void 0,s&&xs(t[0],t[1],s)&&(o=n<3?void 0:o,n=1),e=Object(e);++i<n;){var a=t[i];a&&r(e,a,i,o)}return e})}function Ss(r){return function(e,t,i){for(var n=-1,o=Object(e),s=i(e),a=s.length;a--;){var u=s[r?a:++n];if(t(o[u],u,o)===!1)break}return e}}function ii(r,e,t,i,n,o){return te(r)&&te(e)&&(o.set(e,r),_t(r,e,void 0,ii,o),o.delete(e)),r}function ot(r,e){var t=r.__data__;return Cs(e)?t[typeof e=="string"?"string":"hash"]:t.map}function St(r,e){var t=Ln(r,e);return ds(t)?t:void 0}function Es(r){var e=re.call(r,ue),t=r[ue];try{r[ue]=void 0;var i=!0}catch{}var n=Xr.call(r);return i&&(e?r[ue]=t:delete r[ue]),n}function ks(r){return typeof r.constructor=="function"&&!si(r)?Vn(ei(r)):{}}function ni(r,e){var t=typeof r;return e=e??Hr,!!e&&(t=="number"||t!="symbol"&&In.test(r))&&r>-1&&r%1==0&&r<e}function xs(r,e,t){if(!te(t))return!1;var i=typeof e;return(i=="number"?Et(t)&&ni(e,t.length):i=="string"&&e in t)?at(t[e],r):!1}function Cs(r){var e=typeof r;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?r!=="__proto__":r===null}function Is(r){return!!$r&&$r in r}function si(r){var e=r&&r.constructor,t=typeof e=="function"&&e.prototype||rt;return r===t}function Rs(r){var e=[];if(r!=null)for(var t in Object(r))e.push(t);return e}function Ps(r){return Xr.call(r)}function Ts(r,e,t){return e=Wr(e===void 0?r.length-1:e,0),function(){for(var i=arguments,n=-1,o=Wr(i.length-e,0),s=Array(o);++n<o;)s[n]=i[e+n];n=-1;for(var a=Array(e+1);++n<e;)a[n]=i[n];return a[e]=t(s),Qr(r,this,a)}}function bt(r,e){if(!(e==="constructor"&&typeof r[e]=="function")&&e!="__proto__")return r[e]}var Ls=Us(hs);function Us(r){var e=0,t=0;return function(){var i=jn(),n=Zi-(i-t);if(t=i,n>0){if(++e>=Ji)return arguments[0]}else e=0;return r.apply(void 0,arguments)}}function As(r){if(r!=null){try{return it.call(r)}catch{}try{return r+""}catch{}}return""}function at(r,e){return r===e||r!==r&&e!==e}var yt=Nr(function(){return arguments}())?Nr:function(r){return Fe(r)&&re.call(r,"callee")&&!$n.call(r,"callee")},wt=Array.isArray;function Et(r){return r!=null&&ai(r.length)&&!kt(r)}function Os(r){return Fe(r)&&Et(r)}var oi=Bn||js;function kt(r){if(!te(r))return!1;var e=st(r);return e==zr||e==nn||e==Xi||e==cn}function ai(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=Hr}function te(r){var e=typeof r;return r!=null&&(e=="object"||e=="function")}function Fe(r){return r!=null&&typeof r=="object"}function Ms(r){if(!Fe(r)||st(r)!=Kr)return!1;var e=ei(r);if(e===null)return!0;var t=re.call(e,"constructor")&&e.constructor;return typeof t=="function"&&t instanceof t&&it.call(t)==Mn}var ci=Dr?Tn(Dr):ps;function Ds(r){return vs(r,li(r))}var $s=ri(function(r){return r.push(void 0,ii),Qr(Fs,void 0,r)});function li(r){return Et(r)?cs(r,!0):ms(r)}var Fs=_s(function(r,e,t,i){_t(r,e,t,i)});function Bs(r){return function(){return r}}function ui(r){return r}function js(){return!1}he.exports=$s});var je=(r,e,t="default")=>{let i=document.createElement("li");if(i.classList.add("sl-popup-item"),i.setAttribute("data-type",t),t!="default"){let u=document.createElement("div");u.classList.add("sl-popup-icon"),u.classList.add(`sl-popup-${t}-icon`),i.appendChild(u)}let n=document.createElement("div");n.classList.add("sl-popup-close"),i.appendChild(n),n.addEventListener("click",()=>i.remove());let o=document.createElement("div");o.classList.add("sl-popup-text-container");let s=document.createElement("h3");s.innerText=r,o.appendChild(s);let a=document.createElement("p");if(a.innerHTML=e,o.appendChild(a),i.appendChild(o),document.getElementById("sl-popup-container"))document.getElementById("sl-popup-container").appendChild(i);else{let u=document.createElement("ul");u.id="sl-popup-container",u.appendChild(i),document.getElementsByTagName("body")[0].appendChild(u)}},_e=(r,e)=>{je(r,e,"success")},Se=(r,e)=>{je(r,e,"warning")},ct=(r,e)=>{je(r,e,"error")},J=(r,e)=>{je(r,e)};function We(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)r[i]=t[i]}return r}var vi={read:function(r){return r[0]==='"'&&(r=r.slice(1,-1)),r.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(r){return encodeURIComponent(r).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function lt(r,e){function t(n,o,s){if(!(typeof document>"u")){s=We({},e,s),typeof s.expires=="number"&&(s.expires=new Date(Date.now()+s.expires*864e5)),s.expires&&(s.expires=s.expires.toUTCString()),n=encodeURIComponent(n).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var a="";for(var u in s)!s[u]||(a+="; "+u,s[u]!==!0&&(a+="="+s[u].split(";")[0]));return document.cookie=n+"="+r.write(o,n)+a}}function i(n){if(!(typeof document>"u"||arguments.length&&!n)){for(var o=document.cookie?document.cookie.split("; "):[],s={},a=0;a<o.length;a++){var u=o[a].split("="),c=u.slice(1).join("=");try{var l=decodeURIComponent(u[0]);if(s[l]=r.read(c,l),n===l)break}catch{}}return n?s[n]:s}}return Object.create({set:t,get:i,remove:function(n,o){t(n,"",We({},o,{expires:-1}))},withAttributes:function(n){return lt(this.converter,We({},this.attributes,n))},withConverter:function(n){return lt(We({},this.converter,n),this.attributes)}},{attributes:{value:Object.freeze(e)},converter:{value:Object.freeze(r)}})}var _i=lt(vi,{path:"/"}),V=_i;var Dt="thumbmark",$t="https://api.thumbmarkjs.com",Ge={exclude:[],include:[],stabilize:["private","iframe"],logging:!0,timeout:5e3,cache_api_call:!0,cache_lifetime_in_ms:0,performance:!1,experimental:!1,property_name_factory:r=>`${Dt}_${r}`},qs={...Ge};var Si={private:[{exclude:["canvas"],browsers:["firefox","safari>=17","brave"]},{exclude:["audio"],browsers:["samsungbrowser","safari"]},{exclude:["fonts"],browsers:["firefox"]},{exclude:["audio.sampleHash","hardware.deviceMemory","header.acceptLanguage.q","system.hardwareConcurrency","plugins"],browsers:["brave"]},{exclude:["tls.extensions"],browsers:["firefox","chrome","safari"]},{exclude:["header.acceptLanguage"],browsers:["edge","chrome"]}],iframe:[{exclude:["system.applePayVersion","system.cookieEnabled"],browsers:["safari"]},{exclude:["permissions"]}],vpn:[{exclude:["ip"]}]};function Ei(r){let e=0;for(let t=0;t<r.length;++t)e+=Math.abs(r[t]);return e}function Rt(r,e,t){let i=[];for(let o=0;o<r[0].data.length;o++){let s=[];for(let a=0;a<r.length;a++)s.push(r[a].data[o]);i.push(ki(s))}let n=new Uint8ClampedArray(i);return new ImageData(n,e,t)}function ki(r){if(r.length===0)return 0;let e={};for(let i of r)e[i]=(e[i]||0)+1;let t=r[0];for(let i in e)e[i]>e[t]&&(t=parseInt(i,10));return t}function Ne(r){return r^=r>>>16,r=Math.imul(r,2246822507),r^=r>>>13,r=Math.imul(r,3266489909),(r^=r>>>16)>>>0}var M=new Uint32Array([597399067,2869860233,951274213,2716044179]);function W(r,e){return r<<e|r>>>32-e}function N(r,e=0){var t;if(e=e?0|e:0,typeof r=="string"&&(t=r,r=new TextEncoder().encode(t).buffer),!(r instanceof ArrayBuffer))throw new TypeError("Expected key to be ArrayBuffer or string");let i=new Uint32Array([e,e,e,e]);(function(o,s){let a=o.byteLength/16|0,u=new Uint32Array(o,0,4*a);for(let c=0;c<a;c++){let l=u.subarray(4*c,4*(c+1));l[0]=Math.imul(l[0],M[0]),l[0]=W(l[0],15),l[0]=Math.imul(l[0],M[1]),s[0]=s[0]^l[0],s[0]=W(s[0],19),s[0]=s[0]+s[1],s[0]=Math.imul(s[0],5)+1444728091,l[1]=Math.imul(l[1],M[1]),l[1]=W(l[1],16),l[1]=Math.imul(l[1],M[2]),s[1]=s[1]^l[1],s[1]=W(s[1],17),s[1]=s[1]+s[2],s[1]=Math.imul(s[1],5)+197830471,l[2]=Math.imul(l[2],M[2]),l[2]=W(l[2],17),l[2]=Math.imul(l[2],M[3]),s[2]=s[2]^l[2],s[2]=W(s[2],15),s[2]=s[2]+s[3],s[2]=Math.imul(s[2],5)+2530024501,l[3]=Math.imul(l[3],M[3]),l[3]=W(l[3],18),l[3]=Math.imul(l[3],M[0]),s[3]=s[3]^l[3],s[3]=W(s[3],13),s[3]=s[3]+s[0],s[3]=Math.imul(s[3],5)+850148119}})(r,i),function(o,s){let a=o.byteLength/16|0,u=o.byteLength%16,c=new Uint32Array(4),l=new Uint8Array(o,16*a,u);switch(u){case 15:c[3]=c[3]^l[14]<<16;case 14:c[3]=c[3]^l[13]<<8;case 13:c[3]=c[3]^l[12],c[3]=Math.imul(c[3],M[3]),c[3]=W(c[3],18),c[3]=Math.imul(c[3],M[0]),s[3]=s[3]^c[3];case 12:c[2]=c[2]^l[11]<<24;case 11:c[2]=c[2]^l[10]<<16;case 10:c[2]=c[2]^l[9]<<8;case 9:c[2]=c[2]^l[8],c[2]=Math.imul(c[2],M[2]),c[2]=W(c[2],17),c[2]=Math.imul(c[2],M[3]),s[2]=s[2]^c[2];case 8:c[1]=c[1]^l[7]<<24;case 7:c[1]=c[1]^l[6]<<16;case 6:c[1]=c[1]^l[5]<<8;case 5:c[1]=c[1]^l[4],c[1]=Math.imul(c[1],M[1]),c[1]=W(c[1],16),c[1]=Math.imul(c[1],M[2]),s[1]=s[1]^c[1];case 4:c[0]=c[0]^l[3]<<24;case 3:c[0]=c[0]^l[2]<<16;case 2:c[0]=c[0]^l[1]<<8;case 1:c[0]=c[0]^l[0],c[0]=Math.imul(c[0],M[0]),c[0]=W(c[0],15),c[0]=Math.imul(c[0],M[1]),s[0]=s[0]^c[0]}}(r,i),function(o,s){s[0]=s[0]^o.byteLength,s[1]=s[1]^o.byteLength,s[2]=s[2]^o.byteLength,s[3]=s[3]^o.byteLength,s[0]=s[0]+s[1]|0,s[0]=s[0]+s[2]|0,s[0]=s[0]+s[3]|0,s[1]=s[1]+s[0]|0,s[2]=s[2]+s[0]|0,s[3]=s[3]+s[0]|0,s[0]=Ne(s[0]),s[1]=Ne(s[1]),s[2]=Ne(s[2]),s[3]=Ne(s[3]),s[0]=s[0]+s[1]|0,s[0]=s[0]+s[2]|0,s[0]=s[0]+s[3]|0,s[1]=s[1]+s[0]|0,s[2]=s[2]+s[0]|0,s[3]=s[3]+s[0]|0}(r,i);let n=new Uint8Array(i.buffer);return Array.from(n).map(o=>o.toString(16).padStart(2,"0")).join("")}var Pt=280;async function Ft(r){for(var e;!document.body;)await xi(50);let t=document.createElement("iframe");t.setAttribute("frameBorder","0");let i=t.style;i.setProperty("position","fixed"),i.setProperty("display","block","important"),i.setProperty("visibility","visible"),i.setProperty("border","0"),i.setProperty("opacity","0"),t.src="about:blank",document.body.appendChild(t);let n=t.contentDocument||((e=t.contentWindow)===null||e===void 0?void 0:e.document);if(!n)throw new Error("Iframe document is not accessible");r({iframe:n}),setTimeout(()=>{document.body.removeChild(t)},0)}function xi(r,e){return new Promise(t=>setTimeout(t,r,e))}var Ci=["Arial","Arial Black","Arial Narrow","Arial Rounded MT","Arimo","Archivo","Barlow","Bebas Neue","Bitter","Bookman","Calibri","Cabin","Candara","Century","Century Gothic","Comic Sans MS","Constantia","Courier","Courier New","Crimson Text","DM Mono","DM Sans","DM Serif Display","DM Serif Text","Dosis","Droid Sans","Exo","Fira Code","Fira Sans","Franklin Gothic Medium","Garamond","Geneva","Georgia","Gill Sans","Helvetica","Impact","Inconsolata","Indie Flower","Inter","Josefin Sans","Karla","Lato","Lexend","Lucida Bright","Lucida Console","Lucida Sans Unicode","Manrope","Merriweather","Merriweather Sans","Montserrat","Myriad","Noto Sans","Nunito","Nunito Sans","Open Sans","Optima","Orbitron","Oswald","Pacifico","Palatino","Perpetua","PT Sans","PT Serif","Poppins","Prompt","Public Sans","Quicksand","Rajdhani","Recursive","Roboto","Roboto Condensed","Rockwell","Rubik","Segoe Print","Segoe Script","Segoe UI","Sora","Source Sans Pro","Space Mono","Tahoma","Taviraj","Times","Times New Roman","Titillium Web","Trebuchet MS","Ubuntu","Varela Round","Verdana","Work Sans"],Ii=["monospace","sans-serif","serif"];function Tt(r,e){if(!r)throw new Error("Canvas context not supported");return r.font=`72px ${e}`,r.measureText("WwMmLli0Oo").width}function Ri(){var r;let e=document.createElement("canvas"),t=(r=e.getContext("webgl"))!==null&&r!==void 0?r:e.getContext("experimental-webgl");if(t&&"getParameter"in t)try{let i=(t.getParameter(t.VENDOR)||"").toString(),n=(t.getParameter(t.RENDERER)||"").toString(),o={vendor:i,renderer:n,version:(t.getParameter(t.VERSION)||"").toString(),shadingLanguageVersion:(t.getParameter(t.SHADING_LANGUAGE_VERSION)||"").toString()};if(!n.length||!i.length){let s=t.getExtension("WEBGL_debug_renderer_info");if(s){let a=(t.getParameter(s.UNMASKED_VENDOR_WEBGL)||"").toString(),u=(t.getParameter(s.UNMASKED_RENDERER_WEBGL)||"").toString();a&&(o.vendorUnmasked=a),u&&(o.rendererUnmasked=u)}}return o}catch{}return"undefined"}function Pi(){let r=new Float32Array(1),e=new Uint8Array(r.buffer);return r[0]=1/0,r[0]=r[0]-r[0],e[3]}var qe=(r,e,t,i)=>{let n=(t-e)/i,o=0;for(let s=0;s<i;s++)o+=r(e+(s+.5)*n);return o*n};function Ti(r,e){let t={};return e.forEach(i=>{let n=function(o){if(o.length===0)return null;let s={};o.forEach(c=>{let l=String(c);s[l]=(s[l]||0)+1});let a=o[0],u=1;return Object.keys(s).forEach(c=>{s[c]>u&&(a=c,u=s[c])}),a}(r.map(o=>i in o?o[i]:void 0).filter(o=>o!==void 0));n&&(t[i]=n)}),t}var Li=["accelerometer","accessibility","accessibility-events","ambient-light-sensor","background-fetch","background-sync","bluetooth","camera","clipboard-read","clipboard-write","device-info","display-capture","gyroscope","geolocation","local-fonts","magnetometer","microphone","midi","nfc","notifications","payment-handler","persistent-storage","push","speaker","storage-access","top-level-storage-access","window-management","query"];function dt(){var r,e,t,i,n,o;if(typeof navigator>"u")return{name:"unknown",version:"unknown"};let s=navigator.userAgent,a=[/(?<name>SamsungBrowser)\/(?<version>\d+(?:\.\d+)+)/,/(?<name>EdgA|EdgiOS|Edg)\/(?<version>\d+(?:\.\d+)+)/,/(?<name>OPR|OPX)\/(?<version>\d+(?:\.\d+)+)/,/Opera[\s\/](?<version>\d+(?:\.\d+)+)/,/Opera Mini\/(?<version>\d+(?:\.\d+)+)/,/Opera Mobi\/(?<version>\d+(?:\.\d+)+)/,/(?<name>Vivaldi)\/(?<version>\d+(?:\.\d+)+)/,/(?<name>Brave)\/(?<version>\d+(?:\.\d+)+)/,/(?<name>CriOS)\/(?<version>\d+(?:\.\d+)+)/,/(?<name>FxiOS)\/(?<version>\d+(?:\.\d+)+)/,/(?<name>Chrome|Chromium)\/(?<version>\d+(?:\.\d+)+)/,/(?<name>Firefox|Waterfox|Iceweasel|IceCat)\/(?<version>\d+(?:\.\d+)+)/,/Version\/(?<version1>[\d.]+).*Safari\/[\d.]+|(?<name>Safari)\/(?<version2>[\d.]+)/,/(?<name>MSIE|Trident|IEMobile).+?(?<version>\d+(?:\.\d+)+)/,/(?<name>[A-Za-z]+)\/(?<version>\d+(?:\.\d+)+)/],u={edg:"Edge",edga:"Edge",edgios:"Edge",opr:"Opera",opx:"Opera",crios:"Chrome",fxios:"Firefox",samsung:"SamsungBrowser",vivaldi:"Vivaldi",brave:"Brave"};for(let c of a){let l=s.match(c);if(l){let d=(r=l.groups)===null||r===void 0?void 0:r.name,f=((e=l.groups)===null||e===void 0?void 0:e.version)||((t=l.groups)===null||t===void 0?void 0:t.version1)||((i=l.groups)===null||i===void 0?void 0:i.version2);if(d||!(!((n=l.groups)===null||n===void 0)&&n.version1)&&!(!((o=l.groups)===null||o===void 0)&&o.version2)||(d="Safari"),!d&&c.source.includes("Opera Mini")&&(d="Opera Mini"),!d&&c.source.includes("Opera Mobi")&&(d="Opera Mobi"),!d&&c.source.includes("Opera")&&(d="Opera"),!d&&l[1]&&(d=l[1]),!f&&l[2]&&(f=l[2]),d)return{name:u[d.toLowerCase()]||d,version:f||"unknown"}}}return{name:"unknown",version:"unknown"}}function Lt(){if(typeof navigator>"u"||!navigator.userAgent)return!1;let r=navigator.userAgent;return/Mobi|Android|iPhone|iPod|IEMobile|Opera Mini|Opera Mobi|webOS|BlackBerry|Windows Phone/i.test(r)&&!/iPad/i.test(r)}function Ui(){let r=[],e={"prefers-contrast":["high","more","low","less","forced","no-preference"],"any-hover":["hover","none"],"any-pointer":["none","coarse","fine"],pointer:["none","coarse","fine"],hover:["hover","none"],update:["fast","slow"],"inverted-colors":["inverted","none"],"prefers-reduced-motion":["reduce","no-preference"],"prefers-reduced-transparency":["reduce","no-preference"],scripting:["none","initial-only","enabled"],"forced-colors":["active","none"]};return Object.keys(e).forEach(t=>{e[t].forEach(i=>{matchMedia(`(${t}: ${i})`).matches&&r.push(`${t}: ${i}`)})}),r}function Ai(){if(window.location.protocol==="https:"&&typeof window.ApplePaySession=="function")try{let r=window.ApplePaySession.supportsVersion;for(let e=15;e>0;e--)if(r(e))return e}catch{return 0}return 0}var Oi=dt().name!=="SamsungBrowser"?1:3,D,b=null;function G(r){let e=[];return function t(i){if(i&&i.toJSON&&typeof i.toJSON=="function"&&(i=i.toJSON()),i===void 0)return;if(typeof i=="number")return isFinite(i)?""+i:"null";if(typeof i!="object")return JSON.stringify(i);let n,o;if(Array.isArray(i)){for(o="[",n=0;n<i.length;n++)n&&(o+=","),o+=t(i[n])||"null";return o+"]"}if(i===null)return"null";if(e.indexOf(i)!==-1)throw new TypeError("Converting circular structure to JSON");let s=e.push(i)-1,a=Object.keys(i).sort();for(o="",n=0;n<a.length;n++){let u=a[n],c=t(i[u]);c&&(o&&(o+=","),o+=JSON.stringify(u)+":"+c)}return e.splice(s,1),"{"+o+"}"}(r)||""}var Bt=["\u{1D504}","\u{1D505}","\u212D","\u{1D507}","\u{1D508}","\u{1D509}","\u{1D538}","\u{1D539}","\u2102","\u{1D53B}","\u{1D53C}","\u{1D53D}"],jt=["\u03B2","\u03C8","\u03BB","\u03B5","\u03B6","\u03B1","\u03BE","\u03BC","\u03C1","\u03C6","\u03BA","\u03C4","\u03B7","\u03C3","\u03B9","\u03C9","\u03B3","\u03BD","\u03C7","\u03B4","\u03B8","\u03C0","\u03C5","\u03BF"];function Ee(r,e){return`<math><mrow>${e}</mrow></math>`}function Mi(){let r="<mo>\u220F</mo>";return Bt.forEach((e,t)=>{let i=2*t,n=jt.slice(i,i+2);n.length===2&&(r+=`<mmultiscripts><mi>${e}</mi><none/><mi>${n[1]}</mi><mprescripts></mprescripts><mi>${n[0]}</mi><none/></mmultiscripts>`)}),Ee(0,`<munderover><mmultiscripts>${r}</mmultiscripts></munderover>`)}function Di(){let r=[];return Bt.forEach((e,t)=>{let i=2*t,n=jt.slice(i,i+2);n.length===2&&r.push(Ee(0,`<mmultiscripts><mi>${e}</mi><none/><mi>${n[1]}</mi><mprescripts></mprescripts><mi>${n[0]}</mi><none/></mmultiscripts>`))}),r}var $i={audio:async function(){return async function(){return new Promise((r,e)=>{try{let n=new(window.OfflineAudioContext||window.webkitOfflineAudioContext)(1,5e3,44100),o=n.createBufferSource(),s=n.createOscillator();s.frequency.value=1e3;let a=n.createDynamicsCompressor(),u;a.threshold.value=-50,a.knee.value=40,a.ratio.value=12,a.attack.value=0,a.release.value=.2,s.connect(a),a.connect(n.destination),s.start(),n.oncomplete=c=>{u=c.renderedBuffer.getChannelData(0),r({sampleHash:Ei(u),maxChannels:n.destination.maxChannelCount,channelCountMode:o.channelCountMode})},n.startRendering()}catch(t){console.error("Error creating audio fingerprint:",t),e(t)}})}()},canvas:async function(){return new Promise(r=>{let e=Array.from({length:3},()=>function(){let t=document.createElement("canvas"),i=t.getContext("2d");if(!i)return new ImageData(1,1);t.width=Pt,t.height=20;let n=i.createLinearGradient(0,0,t.width,t.height);n.addColorStop(0,"red"),n.addColorStop(.16666666666666666,"orange"),n.addColorStop(.3333333333333333,"yellow"),n.addColorStop(.5,"green"),n.addColorStop(.6666666666666666,"blue"),n.addColorStop(.8333333333333334,"indigo"),n.addColorStop(1,"violet"),i.fillStyle=n,i.fillRect(0,0,t.width,t.height);let o="Random Text WMwmil10Oo";return i.font="23.123px Arial",i.fillStyle="black",i.fillText(o,-5,15),i.fillStyle="rgba(0, 0, 255, 0.5)",i.fillText(o,-3.3,17.7),i.beginPath(),i.moveTo(0,0),i.lineTo(2*t.width/7,t.height),i.strokeStyle="white",i.lineWidth=2,i.stroke(),i.getImageData(0,0,t.width,t.height)}());r({commonPixelsHash:N(Rt(e,Pt,20).data.toString()).toString()})})},fonts:async function(r){return new Promise((e,t)=>{try{Ft(async({iframe:i})=>{let n=i.createElement("canvas").getContext("2d"),o=Ii.map(a=>Tt(n,a)),s={};Ci.forEach(a=>{let u=Tt(n,a);o.includes(u)||(s[a]=u)}),e(s)})}catch{t({error:"unsupported"})}})},hardware:function(){return new Promise((r,e)=>{let t=navigator.deviceMemory!==void 0?navigator.deviceMemory:0,i=window.performance&&window.performance.memory?window.performance.memory:0;r({videocard:Ri(),architecture:Pi(),deviceMemory:t.toString()||"undefined",jsHeapSizeLimit:i.jsHeapSizeLimit||0})})},locales:function(){return new Promise(r=>{r({languages:navigator.language,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone})})},math:function(){return new Promise(r=>{r({acos:Math.acos(.5),asin:qe(Math.asin,-1,1,97),cos:qe(Math.cos,0,Math.PI,97),largeCos:Math.cos(1e20),largeSin:Math.sin(1e20),largeTan:Math.tan(1e20),sin:qe(Math.sin,-Math.PI,Math.PI,97),tan:qe(Math.tan,0,2*Math.PI,97)})})},permissions:async function(r){let e=r?.permissions_to_check||Li;return Ti(await Promise.all(Array.from({length:3},()=>async function(t){let i={};for(let n of t)try{let o=await navigator.permissions.query({name:n});i[n]=o.state.toString()}catch{}return i}(e))),e)},plugins:async function(){let r=[];if(navigator.plugins)for(let e=0;e<navigator.plugins.length;e++){let t=navigator.plugins[e];r.push([t.name,t.filename,t.description].join("|"))}return new Promise(e=>{e({plugins:r})})},screen:function(){return new Promise(r=>{let e={is_touchscreen:navigator.maxTouchPoints>0,maxTouchPoints:navigator.maxTouchPoints,colorDepth:screen.colorDepth,mediaMatches:Ui()};Lt()&&navigator.maxTouchPoints>0&&(e.resolution=function(){let t=window.screen.width,i=window.screen.height,n=Math.max(t,i).toString(),o=Math.min(t,i).toString();return`${n}x${o}`}()),r(e)})},system:function(){return new Promise(r=>{let e=dt();r({platform:window.navigator.platform,productSub:navigator.productSub,product:navigator.product,useragent:navigator.userAgent,hardwareConcurrency:navigator.hardwareConcurrency,browser:{name:e.name,version:e.version},mobile:Lt(),applePayVersion:Ai(),cookieEnabled:window.navigator.cookieEnabled})})},webgl:async function(){typeof document<"u"&&(D=document.createElement("canvas"),D.width=200,D.height=100,b=D.getContext("webgl"));try{if(!b)throw new Error("WebGL not supported");let r=Array.from({length:Oi},()=>function(){try{if(!b)throw new Error("WebGL not supported");let e=`
          attribute vec2 position;
          void main() {
              gl_Position = vec4(position, 0.0, 1.0);
          }
      `,t=`
          precision mediump float;
          void main() {
              gl_FragColor = vec4(0.812, 0.195, 0.553, 0.921); // Set line color
          }
      `,i=b.createShader(b.VERTEX_SHADER),n=b.createShader(b.FRAGMENT_SHADER);if(!i||!n)throw new Error("Failed to create shaders");if(b.shaderSource(i,e),b.shaderSource(n,t),b.compileShader(i),!b.getShaderParameter(i,b.COMPILE_STATUS))throw new Error("Vertex shader compilation failed: "+b.getShaderInfoLog(i));if(b.compileShader(n),!b.getShaderParameter(n,b.COMPILE_STATUS))throw new Error("Fragment shader compilation failed: "+b.getShaderInfoLog(n));let o=b.createProgram();if(!o)throw new Error("Failed to create shader program");if(b.attachShader(o,i),b.attachShader(o,n),b.linkProgram(o),!b.getProgramParameter(o,b.LINK_STATUS))throw new Error("Shader program linking failed: "+b.getProgramInfoLog(o));b.useProgram(o);let s=137,a=new Float32Array(4*s),u=2*Math.PI/s;for(let f=0;f<s;f++){let g=f*u;a[4*f]=0,a[4*f+1]=0,a[4*f+2]=Math.cos(g)*(D.width/2),a[4*f+3]=Math.sin(g)*(D.height/2)}let c=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,c),b.bufferData(b.ARRAY_BUFFER,a,b.STATIC_DRAW);let l=b.getAttribLocation(o,"position");b.enableVertexAttribArray(l),b.vertexAttribPointer(l,2,b.FLOAT,!1,0,0),b.viewport(0,0,D.width,D.height),b.clearColor(0,0,0,1),b.clear(b.COLOR_BUFFER_BIT),b.drawArrays(b.LINES,0,2*s);let d=new Uint8ClampedArray(D.width*D.height*4);return b.readPixels(0,0,D.width,D.height,b.RGBA,b.UNSIGNED_BYTE,d),new ImageData(d,D.width,D.height)}catch{return new ImageData(1,1)}finally{b&&(b.bindBuffer(b.ARRAY_BUFFER,null),b.useProgram(null),b.viewport(0,0,b.drawingBufferWidth,b.drawingBufferHeight),b.clearColor(0,0,0,0))}}());return{commonPixelsHash:N(Rt(r,D.width,D.height).data.toString()).toString()}}catch{return{webgl:"unsupported"}}}},Fi={webrtc:async function(){return new Promise(r=>{try{let e=window.RTCPeerConnection||window.webkitRTCPeerConnection||window.mozRTCPeerConnection;if(!e)return void r({supported:!1,error:"WebRTC not supported"});let t=new e({iceCandidatePoolSize:1,iceServers:[]});t.createDataChannel(""),(async()=>{try{let i={offerToReceiveAudio:!0,offerToReceiveVideo:!0},n=await t.createOffer(i);await t.setLocalDescription(n);let o=n.sdp||"",s=[...new Set((o.match(/extmap:\d+ [^\n\r]+/g)||[]).map(g=>g.replace(/extmap:\d+ /,"")))].sort(),a=g=>{let h=o.match(new RegExp(`m=${g} [^\\s]+ [^\\s]+ ([^\\n\\r]+)`));return h?h[1].split(" "):[]},u=(g,h)=>h.map(w=>{let x=new RegExp(`(rtpmap|fmtp|rtcp-fb):${w} (.+)`,"g"),S=[...o.matchAll(x)];if(!S.length)return null;let E={};return S.forEach(L=>{let[H,B,j]=L,A=j.split("/");B==="rtpmap"?(E.mimeType=`${g}/${A[0]}`,E.clockRate=+A[1],g==="audio"&&(E.channels=+A[2]||1)):B==="rtcp-fb"?(E.feedbackSupport=E.feedbackSupport||[],E.feedbackSupport.push(j)):B==="fmtp"&&(E.sdpFmtpLine=j)}),E}).filter(Boolean),c=u("audio",a("audio")),l=u("video",a("video")),d={audio:{count:c.length,hash:N(G(c))},video:{count:l.length,hash:N(G(l))},extensionsHash:N(G(s))},f=await new Promise(g=>{let h=setTimeout(()=>{t.removeEventListener("icecandidate",w),t.close(),g({supported:!0,...d,timeout:!0})},3e3),w=x=>{let S=x.candidate;S&&S.candidate&&(clearTimeout(h),t.removeEventListener("icecandidate",w),t.close(),g({supported:!0,...d,candidateType:S.type||""}))};t.addEventListener("icecandidate",w)});r({details:f,hash:N(G(f))})}catch(i){t.close(),r({supported:!0,error:`WebRTC offer failed: ${i.message}`})}})()}catch(e){r({supported:!1,error:`WebRTC error: ${e.message}`})}})},mathml:async function(){return new Promise(r=>{try{Ft(async({iframe:e})=>{try{if(!function(s){try{let a=s.createElement("math");a.innerHTML="<mrow><mi>x</mi></mrow>",a.style.position="absolute",a.style.visibility="hidden",s.body.appendChild(a);let u=a.getBoundingClientRect();return s.body.removeChild(a),u.width>0&&u.height>0}catch{return!1}}(e))return void r({supported:!1,error:"MathML not supported"});let t=[Ee("integral","<msubsup><mo>\u222B</mo><mi>a</mi><mi>b</mi></msubsup><mfrac><mrow><mi>f</mi><mo>(</mo><mi>x</mi><mo>)</mo></mrow><mrow><mi>g</mi><mo>(</mo><mi>x</mi><mo>)</mo></mrow></mfrac><mi>dx</mi>"),Ee("fraction","<mfrac><mrow><mi>\u03C0</mi><mo>\xD7</mo><msup><mi>r</mi><mn>2</mn></msup></mrow><mrow><mn>2</mn><mi>\u03C3</mi></mrow></mfrac>"),Ee("matrix","<mo>[</mo><mtable><mtr><mtd><mi>\u03B1</mi></mtd><mtd><mi>\u03B2</mi></mtd></mtr><mtr><mtd><mi>\u03B3</mi></mtd><mtd><mi>\u03B4</mi></mtd></mtr></mtable><mo>]</mo>"),Mi(),...Di()],i=[],n="";t.forEach((s,a)=>{let u=function(c,l){try{let d=l.createElement("math");d.innerHTML=c.replace(/<\/?math>/g,""),d.style.whiteSpace="nowrap",d.style.position="absolute",d.style.visibility="hidden",d.style.top="-9999px",l.body.appendChild(d);let f=d.getBoundingClientRect(),g=(l.defaultView||window).getComputedStyle(d),h={dimensions:{width:f.width,height:f.height},fontInfo:{fontFamily:g.fontFamily,fontSize:g.fontSize,fontWeight:g.fontWeight,fontStyle:g.fontStyle,lineHeight:g.lineHeight,fontVariant:g.fontVariant||"normal",fontStretch:g.fontStretch||"normal",fontSizeAdjust:g.fontSizeAdjust||"none",textRendering:g.textRendering||"auto",fontFeatureSettings:g.fontFeatureSettings||"normal",fontVariantNumeric:g.fontVariantNumeric||"normal",fontKerning:g.fontKerning||"auto"}};return l.body.removeChild(d),h}catch(d){return{error:d.message}}}(s,e);i.push({width:u.dimensions.width,height:u.dimensions.height}),a===0&&u.fontInfo&&(n=N(G(u.fontInfo)))});let o={fontStyleHash:n,dimensions:i};r({details:o,hash:N(G(o))})}catch(t){r({supported:!1,error:`MathML error: ${t.message}`})}})}catch(e){r({supported:!1,error:`MathML error: ${e.message}`})}})},speech:async function(){return new Promise(r=>{try{if(typeof window>"u"||!window.speechSynthesis||typeof window.speechSynthesis.getVoices!="function")return void r({supported:!1,error:"Speech Synthesis API not supported"});let e=!1,t=null,i=s=>{if(!e){e=!0,t&&clearTimeout(t);try{let a=s.map(c=>{let l=d=>d.replace(/\\/g,"\\\\").replace(/,/g,"\\,");return[l(c.voiceURI||""),l(c.name||""),l(c.lang||""),c.localService?"1":"0",c.default?"1":"0"].join(",")});a.sort();let u={voiceCount:s.length,voicesHash:N(G(a))};r({details:u,hash:N(G(u))})}catch(a){r({supported:!0,error:`Voice processing failed: ${a.message}`})}}},n=window.speechSynthesis.getVoices();if(n.length>0)return void i(n);t=setTimeout(()=>{let s=window.speechSynthesis.getVoices();i(s)},800);let o=()=>{window.speechSynthesis.removeEventListener("voiceschanged",o);let s=window.speechSynthesis.getVoices();i(s)};window.speechSynthesis.addEventListener("voiceschanged",o)}catch(e){r({supported:!1,error:`Speech Synthesis error: ${e.message}`})}})}},Vt={},Bi={timeout:"true"},ji=(r,e,t)=>{Vt[r]=e};function Wt(r,e){var t;let i=dt();if(i.name==="unknown"&&r.system&&typeof r.system=="object"&&!Array.isArray(r.system)){let l=r.system.browser;if(l&&typeof l=="object"&&!Array.isArray(l)){let d=l;i={name:d.name||"unknown",version:d.version||"unknown"}}}let n=i.name.toLowerCase(),o=i.version.split(".")[0]||"0",s=parseInt(o,10),a=[...e?.exclude||[]],u=e?.stabilize||[],c=e?.include||[];for(let l of u){let d=Si[l];if(d)for(let f of d){let g=!("browsers"in f),h=!g&&((t=f.browsers)===null||t===void 0?void 0:t.some(w=>{let x=w.match(/(.+?)(>=)(\d+)/);if(x){let[,S,,E]=x,L=parseInt(E,10);return n===S&&s>=L}return n===w}));(g||h)&&a.push(...f.exclude)}}return function l(d,f=""){let g={};for(let[h,w]of Object.entries(d)){let x=f?`${f}.${h}`:h;if(typeof w!="object"||Array.isArray(w)||w===null){let S=a.some(L=>x.startsWith(L)),E=c.some(L=>x.startsWith(L));S&&!E||(g[h]=w)}else{let S=l(w,x);Object.keys(S).length>0&&(g[h]=S)}}return g}(r)}var Nt="visitor_id";function qt(r){return r.storage_property_name?r.storage_property_name:r.property_name_factory(Nt)}var Ut=`${Dt}_${Nt}`;function At(r,e){try{localStorage.setItem(qt(e),r)}catch{}}var Ht="cache";function Ot(r){try{let e=localStorage.getItem(r.property_name_factory(Ht));return JSON.parse(e)||{}}catch{}return{}}function Vi(r){return r.cache_lifetime_in_ms>2592e5?Date.now()+2592e5:Date.now()+r.cache_lifetime_in_ms}var pe=null,ut=null,Wi=(r,e)=>{if(r.cache_api_call){if(ut)return Promise.resolve(ut);let u=function(c){let l=Ot(c);if(l&&l.apiResponse&&l.apiResponseExpiry&&Date.now()<=l.apiResponseExpiry)return l.apiResponse}(r);if(u)return Promise.resolve(u)}if(pe)return pe;let t=`${r.api_endpoint||$t}/thumbmark`,i=function(u){try{let c=qt(u),l=localStorage.getItem(c);return l||c===Ut||(l=localStorage.getItem(Ut),l&&At(l,u)),l}catch{return null}}(r),n={components:e,options:r,clientHash:N(G(e)),version:"1.6.0"};i&&(n.visitorId=i);let o=fetch(t,{method:"POST",headers:{"x-api-key":r.api_key,Authorization:"custom-authorized","Content-Type":"application/json"},body:JSON.stringify(n)}).then(u=>{if(!u.ok)throw u.status===403?new Error("INVALID_API_KEY"):new Error(`HTTP error! status: ${u.status}`);return u.json()}).then(u=>(u.visitorId&&u.visitorId!==i&&At(u.visitorId,r),ut=u,function(c,l){!c.cache_api_call||!c.cache_lifetime_in_ms||function(d,f){let g={...Ot(d),...f};try{localStorage.setItem(d.property_name_factory(Ht),JSON.stringify(g))}catch{}}(c,{apiResponseExpiry:Vi(c),apiResponse:l})}(r,u),pe=null,u)).catch(u=>{if(console.error("Error fetching pro data",u),pe=null,u.message==="INVALID_API_KEY")throw u;return null}),s=r.timeout||5e3,a=new Promise(u=>{setTimeout(()=>{u({info:{timed_out:!0},version:"1.6.0"})},s)});return pe=Promise.race([o,a]),pe};async function Ni(r){var e;let t={...Ge,...r},i=t.logging&&!sessionStorage.getItem("_tmjs_l")&&Math.random()<1e-4,n={...$i,...Vt},{elapsed:o,resolvedComponents:s}=await Mt(n,t),a={},u={};if(i||t.experimental){let{elapsed:S,resolvedComponents:E}=await Mt(Fi,t);a=E,u=S}let c=t.api_key?Wi(t,s):null,l=null;if(c)try{l=await c}catch(S){if(S instanceof Error&&S.message==="INVALID_API_KEY")return{error:"Invalid API key or quota exceeded",components:{},info:{},version:"1.6.0",thumbmark:""};throw S}let d={...o,...u},f=t.performance?{elapsed:d}:{},g=Wt(l?.components||{},t),h={...s,...g},w=l?.info||{uniqueness:{score:"api only"}};console.log(l);let x=(e=l?.thumbmark)!==null&&e!==void 0?e:N(G(h));return i&&async function(S,E,L,H={}){var B;let j=`${$t}/log`,A={thumbmark:S,components:E,experimental:H,version:"1.6.0",options:L,path:(B=window?.location)===null||B===void 0?void 0:B.pathname};sessionStorage.setItem("_tmjs_l","1");try{await fetch(j,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(A)})}catch{}}(x,h,t,a).catch(()=>{}),{...l?.visitorId&&{visitorId:l.visitorId},thumbmark:x,components:h,info:w,version:"1.6.0",...f,...Object.keys(a).length>0&&t.experimental&&{experimental:a}}}async function Mt(r,e){let t={...Ge,...e},i=Object.entries(r).filter(([l])=>{var d;return!(!((d=t?.exclude)===null||d===void 0)&&d.includes(l))}).filter(([l])=>{var d,f,g,h;return!((d=t?.include)===null||d===void 0)&&d.some(w=>w.includes("."))?(f=t?.include)===null||f===void 0?void 0:f.some(w=>w.startsWith(l)):((g=t?.include)===null||g===void 0?void 0:g.length)===0||((h=t?.include)===null||h===void 0?void 0:h.includes(l))}),n=i.map(([l])=>l),o=i.map(([l,d])=>d(e)),s=await function(l,d,f){return Promise.all(l.map(g=>{let h=performance.now();return Promise.race([g.then(S=>({value:S,elapsed:performance.now()-h})),(w=d,x=f,new Promise(S=>{setTimeout(()=>S(x),w)})).then(S=>({value:S,elapsed:performance.now()-h}))]);var w,x}))}(o,t?.timeout||5e3,Bi),a={},u={};s.forEach((l,d)=>{var f;l.value!=null&&(u[n[d]]=l.value,a[n[d]]=(f=l.elapsed)!==null&&f!==void 0?f:0)});let c=Wt(u,t);return{elapsed:a,resolvedComponents:c}}var He=class{constructor(e){this.options={...Ge,...e}}async get(e){return Ni({...this.options,...e})}getVersion(){return"1.6.0"}includeComponent(e,t){ji(e,t)}};var k=r=>new URLSearchParams(window.location.search).get(r),ke=()=>(window.location.origin+window.location.pathname).replace(/\/$/,""),me=r=>new RegExp("^"+r.split(/\*+/).map(qi).join(".*")+"$"),qi=r=>r.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&");var q=r=>{let e=new Event(`sl:${r}`);document.dispatchEvent(e)},Z=()=>!!k("SLVerifyInstall"),ze=()=>k("rh_ref")||k("rh_partner"),xe=()=>Z()&&k("SLVerifyInstall").includes("MF"),O=()=>Z()&&k("SLVerifyInstall").includes("upscribe"),Ke=()=>Z()&&k("SLVerifyInstall").includes("partner_program"),T=()=>window.SL.config.test_mode||k("test_mode")=="true",F=()=>k("debug")=="true",ae=()=>k("partner_mode")=="true",Hi=()=>window.location.hostname==="referralhub.page",Gt=()=>window.location.hostname==="upscribe.page",U=()=>window.SL.config||{},v=(r={})=>{let e=window.SL.visitor||{};return Object.keys(r).length&&(e=Object.assign(e,r)),window.SL.visitor=e,window.SL.visitor},$=(r=null)=>{let e=v();return r&&Object.keys(e).length&&(e.subscriber=r,q("subscriber-updated")),e.subscriber},Gi=()=>Z()?k("rh_ref"):v().referrer,Ce=(r=null)=>{let e=U().widgets.upscribes;return r?e.find(i=>i.uuid==r):e[0]},Ie=()=>{let r=v();return{uuid:U().uuid,referrer_code:Gi(),campaign_id:r.campaign,utm_source:r.utm_source,utm_campaign:r.utm_campaign,origin:r.origin,email:r.email}},pt=()=>k("flash_messages")=="true",zt=()=>{T()&&pt()&&J("TEST MODE ENABLED","You're currently in test mode. No data will be stored while in test mode")},Kt=()=>window.SLConfig.plan!="lite_v3"||T()||Hi(),Q=(r,e,t=30)=>{if(Z()||T())return!1;let i=window.location.hostname.replace("www.","");e&&(V.set(r,e,{expires:t,domain:`.${i}`}),console.log(`${r} tracked`))},Yt=async()=>new He({timeout:2500}).get(),Jt=()=>{document.documentElement.style.setProperty("--sl-widgets-font-family","-apple-system, system-ui"),document.documentElement.style.setProperty("--sl-widgets-base-unit","16px")},Ye=(r,e)=>{let t=`sparkloop-${r}-custom-css`;document.getElementById(t)&&document.getElementById(t).remove();var i=document.createElement("style");i.type="text/css",i.id=t,i.textContent=e,document.head.appendChild(i)},Re=r=>{let e=`sparkloop-${r}-style`;if(document.querySelector(`link#${e}`))return;let t=document.createElement("link");t.id=e,t.setAttribute("rel","stylesheet"),t.setAttribute("href",`${window.SLConfig.app_url}/styles/${r}.css`),document.head.appendChild(t)},ne=r=>{let e=document.createElement("link");e.setAttribute("rel","preload"),e.setAttribute("as","image"),e.setAttribute("href",r),document.head.appendChild(e)},Zt=(r,e,t)=>{let i;if(document.body.createTextRange){let n=document.body.createTextRange();n.moveToElementText(r),n.select()}else if(window.getSelection&&document.createRange){r.readOnly=!1;let n=document.createRange();n.selectNodeContents(r);let o=window.getSelection();o.removeAllRanges(),o.addRange(n),(r.nodeName=="TEXTAREA"||r.nodeName=="INPUT")&&r.select(),r.setSelectionRange&&navigator.userAgent.match(/ipad|ipod|iphone/i)&&(r.setSelectionRange(0,999999),r.readOnly=!0)}try{i=document.execCommand("copy")}catch{i=!1}if(i){let n=e.textContent,o=t;e.textContent=o,setTimeout(()=>e.textContent=n,500),console.log("Referral link copied to clipboard.")}},Je=r=>r.querySelector(`input[type*="email"],
                              input[type*="Email"],
                              input[type*="EMAIL"],
                              input[name*="EMAIL"],
                              input[name*="email"],
                              input[name*="Email"],
                              input[for*="email"],
                              input[for*="Email"],
                              input[for*="EMAIL"]`),Qt=r=>r.querySelector(`input[type*="submit"],
                              input[type*="image"],
                              button[type*="submit"],
                              button:not([type])`),Xt=r=>{let e=!1,t=!1;return r.forEach(i=>{i.querySelector(".gform_body")&&(e=!0),Je(i)&&(t=!0)}),e&&!t},mt=r=>r.hasAttribute("data-sv-form"),Ze=r=>r.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),m=({type:r="div",id:e="",classes:t="",text:i="",html:n="",parent:o,attributes:s={}}={})=>{let a=document.createElement(r);e&&(a.id=e),t&&(a.className=t),i&&(a.innerText=i),n&&(a.innerHTML=n),o&&o.appendChild(a);for(let u in s)a.setAttribute(u,s[u]);return a},er=(r,e,t="")=>{let i=`https://sparkloop.app/${t}?utm_campaign=powered-by&utm_source=${r}&utm_medium=${U().uuid}`;return m({type:"a",attributes:{href:i,target:"_blank"},text:"\u26A1\uFE0F by SparkLoop",parent:e})},tr=()=>{let r=()=>m({html:"<!-- Sparkloop: this plan doesn't support widgets -->"}),e={get:function(){return r}};return new Proxy({},e)};function rr(){if(document.currentScript)return document.currentScript;if(document.querySelector("script[data-sparkloop]"))return document.querySelector("script[data-sparkloop]");if(document.querySelector('script[src^="https://js.sparkloop.app/"]'))return document.querySelector('script[src^="https://js.sparkloop.app/"]');if(document.querySelector('script[src^="https://dash.sparkloop.app/widget/"]'))return document.querySelector('script[src^="https://dash.sparkloop.app/widget/"]')}var ir=()=>{let r=rr(),e=new URL(r.src),t=null;if(e.searchParams.get("publication_id"))t=e.searchParams.get("publication_id");else if(e.pathname.includes("/widget/")&&e.pathname.includes("/embed.js")){let i=e.pathname.match(/\/widget\/([^\/]+)\/embed\.js/);i&&(t=i[1])}else if(e.pathname.includes("/team_")&&e.pathname.endsWith(".js")){let i=e.pathname.match(/\/team_([^\.]+)\.js/);i&&(t=`team_${i[1]}`)}return t},nr=()=>{let e=rr().src,t=e.substring(0,e.lastIndexOf("/"));return t.includes("sparkloop.app")?"https://js.sparkloop.app":t.includes("/widget/")?"https://js.sparkloop.localhost":t},sr=()=>{let r=Date.now(),e=new Uint8Array(10);crypto.getRandomValues(e),e[0]=e[0]&15|112,e[2]=e[2]&63|128;let t=r.toString(16).padStart(12,"0"),i=Array.from(e).map(n=>n.toString(16).padStart(2,"0")).join("");return t.slice(0,8)+"-"+t.slice(8,12)+"-"+i.slice(0,4)+"-"+i.slice(4,8)+"-"+i.slice(8)};var R=async(r,e,t="POST",i={})=>{let n=U(),o=`${n.script_url}/${n.uuid}`,s={method:t,headers:{"Content-Type":"application/json"},keepalive:!0,...i};return t!=="GET"&&e&&(s={...s,body:JSON.stringify(e)}),await(await fetch(o+r,s)).json()},or=r=>R("/add_subscriber",r).then(e=>e),ar=r=>R(`/campaigns/${r.campaign_id}/verify_script`,r).then(e=>e),cr=r=>R(`/campaigns/${r.campaign_id}/test_referral`,r).then(e=>e),lr=(r,e)=>R(`/upscribes/${r}/add_log`,e).then(t=>t),ur=r=>R(`/upscribes/${r}/verify_script`).then(e=>e),dr=r=>R(`/partner_programs/${r}/verify_script`).then(e=>e),pr=r=>R(`/upscribes/${r}/test_widget`).then(e=>e),mr=r=>R(`/partner_programs/${r}/test_referral`).then(e=>e),fr=r=>R(`/partner_campaigns/${r}/partner_test`).then(e=>e),hr=(r,e)=>R(`/upscribes/${r}/track_visit_event`,e).then(t=>t),Qe=(r,e)=>R(`/upscribes/${r}/track_impression_event`,e).then(t=>t),Xe=(r,e)=>R(`/upscribes/${r}/track_subscription_event`,e).then(t=>t),gr=(r,e)=>R(`/upscribes/${r}/track_recommendation_impression_event`,e).then(t=>t),br=r=>R("/check_referral_code",r).then(e=>e),yr=r=>R("/check_partner_code",r).then(e=>e),wr=(r,e)=>R("/get_subscriber",{subscriber:r,...e}).then(t=>t.response==="error"?Promise.reject(t.message):Promise.resolve(t.subscriber)),vr=(r,e)=>R("/upsert_subscriber",{subscriber:r,...e}).then(t=>t.response==="error"?Promise.reject(t.message):Promise.resolve(t.subscriber)),_r=r=>R(`/campaigns/${r.campaign_id}/send_email_invite`,r).then(e=>Promise.resolve(e)).catch(()=>Promise.reject()),Sr=r=>{let t=new AbortController,i=setTimeout(()=>t.abort(),2e3);return R(`/upscribes/${r}/recommendations`,null,"GET",{signal:t.signal}).then(n=>(clearTimeout(i),n)).catch(()=>(clearTimeout(i),{recommendations:[]}))},Er=()=>{let e=new AbortController,t=setTimeout(()=>e.abort(),2e3);return R("/recommended_offers",null,"GET",{signal:e.signal}).then(i=>(clearTimeout(t),i)).catch(()=>(clearTimeout(t),{offer_recommendations:[]}))},kr=(r,e)=>R(`/recommended_offers/${r}/offer_submissions`,e).then(t=>t),xr=r=>R("/recommendation_events",r).then(e=>e),Cr=(r,e)=>{let t=`${r}/${e}/settings`;return fetch(t,{method:"GET"}).then(i=>i.json())};var ce="__sl",Ir=`${ce}-campaign`,Rr=`${ce}-utm_campaign`,Pr=`${ce}-utm_source`,Tr=`${ce}-origin`,Lr=`${ce}-fingerprint`,Ur=`${ce}-referrer`,Ys=`${ce}-session_uuid`,Pe=class{constructor(){this.config=U(),this.visitor={}}storeInfoCookies(){this.visitor.campaign&&Q(`${Ir}-${this.config.uuid}`,this.visitor.campaign),this.visitor.utm_source&&Q(`${Pr}-${this.config.uuid}`,this.visitor.utm_source),this.visitor.utm_campaign&&Q(`${Rr}-${this.config.uuid}`,this.visitor.utm_campaign),this.visitor.origin&&Q(`${Tr}-${this.config.uuid}`,this.visitor.origin)}fetchCampaign(){let e=V.get(`${Ur}-${this.config.uuid}`)?V.get(`${Ir}-${this.config.uuid}`):k("sl_campaign");this.visitor.campaign=this.config.campaign||e||k("sl_campaign")}fetchUTMCampaign(){this.visitor.utm_campaign=this.config.utm_campaign||k("utm_campaign")||V.get(`${Rr}-${this.config.uuid}`)}fetchUTMSource(){let e=k("utm_source")||k("ref")||k("source"),t=V.get(`${Pr}-${this.config.uuid}`),i=document.referrer&&new URL(document.referrer).hostname!=window.location.hostname?new URL(document.referrer).hostname.replace(/^www\./,""):null;this.visitor.utm_source=this.config.utm_source||e||i||t}fetchOrigin(){this.visitor.origin=this.config.origin||V.get(`${Tr}-${this.config.uuid}`)}async fetchAndVerifyReferrer(){let e=`${Ur}-${this.config.uuid}`,t=V.get(e);t&&(this.storeInfoCookies(),this.visitor.referrer=t);let i=ze();if(i){let n={uuid:this.config.uuid,referrer_code:i,campaign_id:this.visitor.campaign,utm_source:this.visitor.utm_source,utm_campaign:this.visitor.utm_campaign,fingerprint:this.visitor.fingerprint},o;try{k("rh_partner")?(o=await yr(n),console.log(`Partner Campaign Referral Code ${i} verified successfully`)):(o=await br(n),console.log("REQ:",o),console.log(`Subscriber Referral code ${i} verified successfully`)),o.response=="ok"?(q("referrer-tracked"),Q(e,i),this.visitor.referrer=i,this.storeInfoCookies()):console.warn(o.message)}catch(s){console.error(s)}}}async fetchFingerprint(){let e=V.get(Lr);if(e)this.visitor.fingerprint=e;else try{let t=await Yt();Q(Lr,t.thumbmark),this.visitor.fingerprint=t.thumbmark}catch(t){console.error(t)}}setSessionUuid(){let e=sr();this.visitor.sessionUuid=e}async profile(){this.setSessionUuid(),this.fetchCampaign(),this.fetchUTMSource(),this.fetchUTMCampaign(),this.fetchOrigin(),await this.fetchFingerprint(),await this.fetchAndVerifyReferrer(),v(this.visitor)}};var zi="__sl",Ar=`${zi}-subscriber`,X=class{constructor(){this.config=U()}subscriberId(){return V.get(`${Ar}-${this.config.uuid}`)||k("subscriber_id")}async fetch({subscriberId:e=null,campaign:t=null}={}){let i=T()?"fake_subscriber":e||this.subscriberId();if(!i)return Promise.reject("Subscriber ID or email not present");let n=Ie();t&&(n.campaign_id=t);try{let o=await wr(i,n);return this.store(o),Promise.resolve(o)}catch(o){return Promise.reject(o)}}async upsert({subscriber:e=null,campaign:t=null}={}){let i=T()?"fake_subscriber":e;if(!i)return Promise.reject();let n=Ie();t&&(n.campaign_id=t);try{let o=await vr(i,n);return this.store(o),Promise.resolve(o)}catch(o){return Promise.reject(o)}}store(e){$(e),Q(`${Ar}-${this.config.uuid}`,e.id),q("subscriber-loaded"),console.log("Subscriber set",{subscriber:e})}};window.confetti={maxCount:150,speed:2,frameInterval:15,alpha:1,gradient:!1,start:null,stop:null,toggle:null,pause:null,resume:null,togglePause:null,remove:null,isPaused:null,isRunning:null};(function(){confetti.start=S,confetti.stop=L,confetti.toggle=B,confetti.pause=h,confetti.resume=w,confetti.togglePause=f,confetti.isPaused=g,confetti.remove=H,confetti.isRunning=j;var r=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame,e=["rgba(30,144,255,","rgba(107,142,35,","rgba(255,215,0,","rgba(255,192,203,","rgba(106,90,205,","rgba(173,216,230,","rgba(238,130,238,","rgba(152,251,152,","rgba(70,130,180,","rgba(244,164,96,","rgba(210,105,30,","rgba(220,20,60,"],t=!1,i=null,n=!1,o=Date.now(),s=[],a=0,u=null,c=window.innerWidth,l=window.innerHeight;function d(y,_,I){return y.color=e[Math.random()*e.length|0]+(confetti.alpha+")"),y.color2=e[Math.random()*e.length|0]+(confetti.alpha+")"),y.x=Math.random()*_,y.y=Math.random()*I-I,y.diameter=Math.random()*10+5,y.tilt=Math.random()*10-10,y.tiltAngleIncrement=Math.random()*.07+.05,y.tiltAngle=Math.random()*Math.PI,y}function f(){n?w():h()}function g(){return n}function h(){n=!0}function w(){n=!1,x()}function x(){if(!n)if(s.length===0)u.clearRect(0,0,c,l),i=null;else{var y=Date.now(),_=y-o;(!r||_>confetti.frameInterval)&&(u.clearRect(0,0,c,l),Be(),A(u),o=y-_%confetti.frameInterval),i=requestAnimationFrame(x)}}function S(y,_,I,{explosion:ye=!1}={}){window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(ve){return window.setTimeout(ve,confetti.frameInterval)}}();var P=document.getElementById("sl-confetti-canvas");P===null?(P=document.createElement("canvas"),P.setAttribute("id","sl-confetti-canvas"),P.setAttribute("style","display:block;z-index:999999;pointer-events:none;position:fixed;top:0"),document.body.prepend(P),P.width=c,P.height=l,window.addEventListener("resize",function(){P.width=window.innerWidth,P.height=window.innerHeight},!0)):(c=P.width,l=P.height),u=P.getContext("2d");var K=confetti.maxCount;if(_)if(I)if(_==I)K=s.length+I;else{if(_>I){var we=_;_=I,I=we}K=s.length+(Math.random()*(I-_)+_|0)}else K=s.length+_;else I&&(K=s.length+I);for(;s.length<K;)s.push(d({},c,l));ye&&E(),t=!0,n=!1,x(),y&&window.setTimeout(L,y)}function E(){for(var y=c/2,_=l/2,I=0;I<s.length;I++){var ye=Math.random()*2*Math.PI,P=Math.random()*confetti.speed;s[I].x=y,s[I].y=_,s[I].explosionVx=Math.cos(ye)*P,s[I].explosionVy=Math.sin(ye)*P,s[I].explosionGravity=P*.05}}function L(){t=!1}function H(){stop(),n=!1,s=[]}function B(){t?L():S()}function j(){return t}function A(y){for(var _,I,ye,P,K,we=0;we<s.length;we++){if(_=s[we],y.beginPath(),y.lineWidth=_.diameter,P=_.x+_.tilt,I=P+_.diameter/2,K=_.y+_.tilt+_.diameter/2,confetti.gradient){var ve=y.createLinearGradient(I,_.y,P,K);ve.addColorStop("0",_.color),ve.addColorStop("1.0",_.color2),y.strokeStyle=ve}else y.strokeStyle=_.color;y.moveTo(I,_.y),y.lineTo(P,K),y.stroke()}}function Be(){var y;a+=.01;for(var _=0;_<s.length;_++)y=s[_],!t&&y.y<-15?y.y=l+100:(y.tiltAngle+=y.tiltAngleIncrement,y.explosionVx?(y.x+=y.explosionVx,y.y+=y.explosionVy,y.explosionVy+=y.explosionGravity):(y.x+=Math.sin(a)-.5,y.y+=(Math.cos(a)+y.diameter+confetti.speed)*.5,y.tilt=Math.sin(y.tiltAngle)*15,(y.x>c+20||y.x<-20||y.y>l)&&(t&&s.length<=confetti.maxCount?d(y,c,l):(s.splice(_,1),_--))))}})();var Te=class{constructor(e){this.upscribeWidget=e,this.upscribe=e.upscribe,this.availableOffers=[],this.currentIndex=0,this.mainElement=null,this.containerElement=null,this.claimedOffers=new Set,this.viewedOffers=new Set,this.channelSubscriptionTracked=!1}generateWidget(){if(!this.hasAvailableOffers()){console.log("No offers available. Widget will not be rendered.");return}let e=document.getElementById("sparkloop-upscribe")?"":"sl-zoomIn";return this.mainElement=m({id:"sparkloop-upscribe",classes:`sl-widget-body ${e}`}),this.#t(),this.#f(),this.mainElement}async fetchOffers(){let e=await Er();this.availableOffers=e.offer_recommendations,this.#m()}hasAvailableOffers(){return this.availableOffers.length>0}#t(){this.viewedOffers.has(this.currentIndex)||(this.viewedOffers.add(this.currentIndex),this.#s("impression"));let e=m({type:"form",attributes:{"data-sparkloop-form-ignore":!0},parent:this.mainElement});this.#o(e),this.#a(e),this.#d(e),this.containerElement&&this.containerElement.replaceWith(e),this.containerElement=e}#o(e){let t=m({type:"header",parent:e});m({type:"h2",text:this.upscribe.offers_header,parent:t}),m({type:"p",text:this.upscribe.offers_subheader,parent:t})}#a(e){let t=this.#e(),i=m({classes:"sl-offer-body",parent:e});this.#c(i);let n=m({classes:"sl-offer-card",parent:i}),o=m({parent:n});m({type:"h2",text:t.headline,classes:"sl-offer-headline",parent:o}),m({type:"p",text:t.description,classes:"sl-offer-desc",parent:o}),t.conversion_type==="lead"&&this.#u(n)}#c(e){let t=this.#e(),i=m({classes:"sl-offer-header",parent:e});if(this.#l(i),t.image_url&&t.image_url.trim().length>0){let n=m({type:"figure",attributes:{style:`background-image: url("${t.image_url}")`,alt:t.headline},classes:"sl-offer-image",parent:i});if(t.callout&&t.callout.trim().length>0){let o=m({classes:"sl-offer-callout",parent:n});m({type:"span",text:t.callout,parent:o}),m({classes:"sl-offer-callout-triangle",parent:o})}}}#l(e){let t=m({classes:"sl-progress-bar",parent:e});this.availableOffers.forEach((i,n)=>{let o=n===this.currentIndex,s=this.viewedOffers.has(n),a=m({parent:t,id:`sl-progress-step-${i.uuid}`,classes:`sl-progress-step ${o?"active":""}`});s?(this.#r(i)?a.classList.add("sl-progress-step--claimed"):m({type:"figure",attributes:{style:`background-image: url("${i.logo_url}")`},classes:"sl-progress-step-logo",parent:a}),o||a.addEventListener("click",()=>{this.currentIndex=n,this.#t()})):a.classList.add("sl-progress-step--inactive")})}#u(e){let t=m({parent:e,classes:"sl-offer-disclaimer"});m({type:"figure",parent:t});let i=`You'll receive an email from our partner ${this.#e().recommended_publication_name} to redeem the offer. `,n=m({type:"p",parent:t,text:i});m({type:"a",attributes:{href:"https://sparkloop.app/policies/terms",target:"_blank"},text:"T&Cs apply",parent:n})}#d(e){let t=m({type:"footer",parent:e}),i;this.#r(this.#e())?i=m({type:"button",text:"Offer claimed successfully!",attributes:{disabled:!0},classes:"sl-button",parent:t}):(i=m({type:"button",text:"Claim offer",classes:"sl-button",parent:t}),i.addEventListener("click",async s=>{s.preventDefault(),this.#p(i)}));let n=this.#i()?"Finalize your subscription":"Next offer \u2192";m({type:"a",text:n,classes:"sl-skip-link",parent:t}).addEventListener("click",()=>{this.#i()?this.#n():(this.currentIndex++,this.#t())})}#e(){return this.availableOffers[this.currentIndex]}#r(e){return this.claimedOffers.has(e.uuid)}#i(){return this.currentIndex===this.availableOffers.length-1}#n(){this.containerElement.style.display="none";let e=m({classes:"sl-upscribe-thank-you-container",parent:this.mainElement});m({type:"figure",parent:e}),m({type:"h2",text:this.upscribe.after_submission.thank_you_message,parent:e}),m({type:"span",text:"Your free subscription + any additional newsletters and offers have been confirmed.",parent:e});let t=this.upscribeWidget.shouldBeRedirected()?"Now redirecting...":"Now closing...";m({type:"span",classes:"sl-upscribe-next-action-message",text:t,parent:e}),setTimeout(()=>{this.upscribeWidget.shouldBeRedirected()?window.location.href=this.upscribeWidget.redirectUrl.toString():this.upscribeWidget.hideUpscribeWidget()},3e3)}async#p(e){e.disabled=!0;let t={subscriber_email:v().email,fingerprint:v().fingerprint,utm_source:v().utm_source,utm_campaign:v().utm_campaign,session_uuid:v().sessionUuid},i=this.#e();try{if(i.conversion_type==="click"||i.conversion_type==="action"){let n=new URL(i.redirect_url);["utm_source","utm_campaign","session_uuid","fingerprint","subscriber_email"].forEach(o=>{let s=t[o];s&&n.searchParams.set(o,s)}),window.open(n.toString(),"_blank")}else await kr(i.uuid,t);this.#r(i)||(this.claimedOffers.add(i.uuid),this.#s("subscription"),this.#h()),e.textContent="Offer claimed successfully!",this.#g(i),setTimeout(()=>{this.#i()?this.#n():(this.currentIndex++,this.#t())},1500)}catch(n){e.disabled=!1,console.error("Failed to create offer submission:",n)}}async#m(){this.availableOffers.forEach(e=>{e.logo_url&&ne(e.logo_url),e.image_url&&ne(e.image_url)})}async#f(){T()||O()||Qe(this.upscribe.uuid,{page:"upscribe_offers",experiment:this.upscribeWidget.experiment,utm_source:v().utm_source,utm_campaign:v().utm_campaign,session_uuid:v().sessionUuid})}async#s(e){if(T()||O())return;let t={type:e,recommendable_type:"OfferRecommendation",recommendable_uuid:this.#e().uuid,experiment:this.upscribeWidget.experiment,session_uuid:v().sessionUuid};try{await xr(t),console.log(`Recommendation ${e} tracked \u2705 ${this.#e().uuid}`)}catch(i){console.error("Failed to track recommendation event:",i)}}async#h(){if(!(T()||O())&&!this.channelSubscriptionTracked)try{Xe(this.upscribe.uuid,{page:"upscribe_offers",experiment:this.upscribeWidget.experiment,subscribed_recommendations:[this.#e().uuid],utm_source:v().utm_source,utm_campaign:v().utm_campaign,session_uuid:v().sessionUuid}),this.channelSubscriptionTracked=!0,console.log("Channel subscription tracked \u2705")}catch(e){console.error("Failed to track channel subscription:",e)}}#g(e){let t=document.getElementById(`sl-progress-step-${e.uuid}`);t.classList.add("sl-progress-step--claimed"),t.querySelector("figure")?.remove();let i=m({type:"canvas",id:"sl-confetti-canvas"});this.mainElement.appendChild(i);let n=t.getBoundingClientRect(),o=i.getBoundingClientRect(),s=n.left+(n.width-o.width)/2,a=n.top+(n.height-o.height)/2;i.style.left=`${s}px`,i.style.top=`${a}px`,confetti.speed=10,confetti.start(1e3,50,50,{explosion:!0}),setTimeout(()=>{confetti.remove(),i.remove()},1e3)}};var le=class{constructor(){this.config=U(),this.visitor=v(),this.upscribe={},this.redirectUrl=null}async load(e=null,t=!0,i=!1){if(this.fetchSettings(e),!!this.upscribe)return this.determineRedirectUrl(),this.shouldDisplayRecommendations()||await this.fetchRecommendations(),this.determineExperiment(),this.loadStyles(),i?this.generateWidget():(this.shouldDisplayRecommendations()?this.loadOffers():await this.loadOffers(),this.buildWidgetOrRedirect(t))}buildWidgetOrRedirect(e=!0){if(!this.shouldDisplayRecommendations()&&!this.shouldDisplayOffers()){console.log("No recommendations available. Upscribe widget not loaded."),(this.shouldBeRedirected()||Gt())&&(window.location.href=this.redirectUrl.toString());return}this.trackUpscribeVisitEvent(),document.body.classList.add("sl-upscribe-open");let t;if(this.shouldDisplayRecommendations()?t=this.generateWidget():this.shouldDisplayOffers()&&(t=this.offers.generateWidget()),e){let i=m({id:"sl-overlay"});return i.replaceChildren(t),document.body.appendChild(i)}return t}shouldDisplayRecommendations(){return this.upscribe.display.recommendations&&this.upscribe.recommendations&&this.upscribe.recommendations.length>0}shouldDisplayOffers(){return this.upscribe.display.offers&&this.offers&&this.offers.hasAvailableOffers()}renderOffersWidget(){if(!this.shouldDisplayOffers())return;let e=this.offers.generateWidget();document.querySelector("#sparkloop-upscribe").replaceWith(e)}generateWidget(){let e=v(),t=e.email,i=this.upscribe;this.trackUpscribeShownEvent();let n=()=>{confirm("Your Upscribe widget was successfully verified. You will be redirected back to SparkLoop soon.")&&(window.location.href=`${this.config.app_url}/upscribe/checklist?script_verified=true`)},o=m({id:"sparkloop-upscribe",classes:"sl-widget-body sl-zoomIn"}),s=m({classes:"sl-upscribe-thank-you-message",text:i.after_submission.thank_you_message,parent:o}),a=m({type:"form",attributes:{"data-sparkloop-form-ignore":!0},parent:o});T()&&o.classList.add("no-animation"),O()&&m({parent:a,classes:"sl-upscribe-verification",html:"To complete the verification, click on the submit button. <br/>Don't worry: no data will be recorded."});let u=m({type:"input",attributes:{type:"hidden",name:"sl-hp",autocomplete:!1},parent:a,classes:"sl-hidden"}),c=m({type:"button",attributes:{type:"submit"},text:i.button_label,classes:"sl-button"});this.shouldCheckRecommendationsByDefault()||(c.disabled=!0),c.disabled||(c.disabled=!0,setTimeout(()=>{c.disabled=!1},1500));let l=this.experiment,d=this.visitor.utm_source,f=this.visitor.utm_campaign,g=this.visitor.fingerprint,h=this.visitor.sessionUuid;c.addEventListener("click",async E=>{if(E.preventDefault(),u.value){this.hideUpscribeWidget();return}let L=a.querySelectorAll('input[type="checkbox"]:checked');if(L.length>0&&e){c.disabled=!0;let H=Array.from(L).map(A=>A.value),j=Array.from(a.querySelectorAll("ul > li[data-impression-tracked]")).map(function(A){return A.querySelector('input[type="checkbox"]').value});if(O())n();else try{let A={subscriber_email:t,partner_campaigns:H.join(","),experiment:l,shown_recommendations:j.join(","),fingerprint:g,ref_code:e.referrer,utm_source:d,utm_campaign:f,session_uuid:h};await lr(i.uuid,A),Xe(i.uuid,{page:"upscribe_recommendations",shown_recommendations:j.join(","),subscribed_recommendations:H.join(","),experiment:l,utm_source:d,utm_campaign:f,session_uuid:h}),c.disabled=!0,this.shouldDisplayOffers()?this.renderOffersWidget():this.shouldBeRedirected()?window.location.href=this.redirectUrl.toString():(a.style.display="none",s.classList.add("show","sl-fadeIn"),setTimeout(()=>{this.hideUpscribeWidget()},2500))}catch(A){console.log(A)}}});let w=m({type:"header",parent:a});i.header&&m({type:"h2",text:i.header,parent:w}),m({type:"p",text:i.subheader,parent:w});let x=m({type:"ul",parent:a});i.recommendations.forEach(E=>{let L=m({type:"li",parent:x}),H=m({type:"label",attributes:{for:E.uuid},parent:L}),B=m({type:"main",parent:H});m({type:"figure",attributes:{style:`background-image: url("${E.publication_logo}")`},parent:B});let j=m({type:"div",parent:B});m({type:"h3",text:E.publication_name,parent:j}),m({type:"p",text:E.description,parent:j});let A=m({parent:H,classes:"sl-upscribe-checkbox"});m({type:"input",id:E.uuid,attributes:{type:"checkbox",name:"partner_campaigns[]",value:E.ref_code},parent:A}).addEventListener("change",function(y){let _=x.querySelectorAll('input[type="checkbox"]:checked');c.disabled=_.length===0}),m({type:"span",parent:A})}),i.recommendations.length===0&&m({type:"div",classes:"sl-instructions",text:"You have no recommendations.",parent:a});let S=m({type:"footer",parent:a});if(i.recommendations.length>0&&(S.appendChild(c),m({type:"a",text:i.skip_link,attributes:{href:this.shouldBeRedirected()?this.redirectUrl.toString():"#"},classes:"sl-skip-link",parent:S}).addEventListener("click",L=>{L.preventDefault(),O()?n():this.shouldDisplayOffers()?this.renderOffersWidget():this.shouldBeRedirected()?window.location.href=this.redirectUrl.toString():(this.hideUpscribeWidget(),document.body.classList.remove("sl-upscribe-open"))})),i.styling.powered_by_enabled){let E=m({type:"p",id:"sl-hub-powered-by",parent:S});er("upscribe",E,"upscribe")}return this.shouldDisplayRecommendations()&&this.setupRecommendationObserver(o),o}determineRedirectUrl(){this.redirectUrl=this.shouldBeRedirected()?this.generateRedirectURL():this.upscribe.after_submission.default_redirect_url}hideUpscribeWidget(){let e=document.querySelector("#sparkloop-upscribe");e.classList.remove("sl-zoomIn");let t=document.querySelector("#sl-overlay")||e;t&&(t.addEventListener("animationend",()=>{t.remove()},{once:!0}),t.classList.add("sl-fadeOut"),document.body.classList.remove("sl-upscribe-open"))}setupRecommendationObserver(e){let t={rootMargin:"0px 0px -135px 0px",threshold:.5},i=new IntersectionObserver((o,s)=>{o.forEach(a=>{if(a.isIntersecting){let u=a.target;if(this.shouldCheckRecommendationsByDefault()){let c=u.querySelector('input[type="checkbox"]');c&&(c.checked=!0)}this.trackRecommendationImpressionEvent(u),s.unobserve(u)}})},t);e.querySelectorAll("form > ul > li").forEach(o=>{i.observe(o)})}async trackRecommendationImpressionEvent(e){if(T()||O()||e.dataset.impressionTracked)return;let t=e.querySelector('input[type="checkbox"]').id;await gr(this.upscribe.uuid,{experiment:this.experiment,recommendation_uuid:t,utm_source:this.visitor.utm_source,utm_campaign:this.visitor.utm_campaign,session_uuid:this.visitor.sessionUuid}),console.log("Impression tracked \u2705",t),e.dataset.impressionTracked=!0}async trackUpscribeVisitEvent(){T()||O()||hr(this.upscribe.uuid,{experiment:this.experiment,utm_source:this.visitor.utm_source,utm_campaign:this.visitor.utm_campaign,session_uuid:this.visitor.sessionUuid})}async trackUpscribeShownEvent(){T()||O()||Qe(this.upscribe.uuid,{page:"upscribe_recommendations",experiment:this.experiment,utm_source:this.visitor.utm_source,utm_campaign:this.visitor.utm_campaign,session_uuid:this.visitor.sessionUuid})}loadStyles(){this.upscribe.recommendations.forEach(e=>ne(e.publication_logo)),Re("upscribe"),document.documentElement.style.setProperty("--sl-widgets-upscribe-primary-color",this.upscribe.styling.colors.primary),Ye("upscribe",this.upscribe.styling.custom_css)}fetchSettings(e){this.upscribe=Ce(e)}async fetchRecommendations(){let e=await Sr(this.upscribe.uuid);this.upscribe={...this.upscribe,...e}}async loadOffers(){if(T()||O())return;let e=new Te(this);await e.fetchOffers(),this.offers=e}shouldBeRedirected(){let{behaviour:e,custom_behaviour_rules:t}=this.upscribe.after_submission;if(e==="redirect")return!0;if(e==="custom_behaviour"){let i=ke(),o=t.filter(a=>a.behaviour==="redirect").some(a=>{let u=me(a.current_url);return i.match(u)}),s=t.every(a=>{let u=me(a.current_url);return!i.match(u)});return o||s}return!1}findRedirectURL(){let e=ke(),{default_redirect_url:t,custom_behaviour_rules:i}=this.upscribe.after_submission,o=i.filter(s=>s.behaviour==="redirect").find(s=>{let a=me(s.current_url);return e.match(a)});return o?(console.log(`Redirection rule found for Upscribe ${this.upscribe.uuid} on ${o.current_url}`),o.redirect_url):(console.log(`No redirection rule found for Upscribe ${this.upscribe.uuid}. Redirecting to default URL: ${t}`),t)}generateRedirectURL(){let e=new URL(this.findRedirectURL()),t=v();t.email&&e.searchParams.append("email",t.email),e.searchParams.append("ref",this.config.widgets.upscribe_ref);let i=window.location.search;return new URLSearchParams(i).forEach(function(o,s){e.searchParams.append(s,o)}),e}shouldCheckRecommendationsByDefault(){return!this.experiment}determineExperiment(){this.experiment=null}};var oe=class{constructor(){this.config=U(),this.formId=0,this.submittedFormsIds=[]}track(){!this.config.scan_forms||(this.trackStandardForms(),document.addEventListener("pico.user.registered",e=>this.trackPicoForms(e)),document.addEventListener("om.Optin.init.submit",e=>this.trackOptinMonsterForms(e)),window.addEventListener("klaviyoForms",e=>this.trackKlaviyoForms(e)),document.addEventListener("MemberSpace.conversion",e=>this.trackMemberSpaceForms(e)),document.addEventListener("ckjs:submission:complete",e=>this.trackConvertKitForms(e)),document.addEventListener("emailoctopus:form.success",e=>this.trackEmailOctopusForms(e)),document.addEventListener("cf:form_submitted:ok",e=>this.trackClickFunnelsForms(e)),document.addEventListener("gform/postRender",e=>this.trackGravityForms(e)),this.trackElementorForms(),this.trackSquareSpaceForms(),this.trackWisepopsForms(),this.trackDynamicForms())}trackForm(e){if(!e.hasAttribute("data-sparkloop-form-ignore")&&!mt(e)&&!e.hasAttribute("data-sparkloop-form-id")){this.formId++,e.dataset.sparkloopFormId=this.formId,console.log("tracking form",e);let t=e.getAttribute("action");t&&!t.includes("#")?e.addEventListener("submit",i=>this.combFormForEmail(e),{once:!0}):this.trackAjaxForm(e)}}trackStandardForms(){document.querySelectorAll(this.config.form_selector||"form").forEach(t=>{this.trackForm(t)})}trackDynamicForms(){let e=i=>{i.forEach(n=>{n.target.querySelectorAll("form").forEach(o=>{this.trackForm(o)})})};new MutationObserver(e).observe(document.body,{childList:!0,subtree:!0})}trackAjaxForm(e){let t=Je(e);if(t){t.addEventListener("keydown",function(n){n.key==="Enter"&&(console.log("Tracked ajax form submission by pressing ENTER key"),this.combFormForEmail(e))},{once:!0});let i=Qt(e);i&&i.addEventListener("click",()=>{console.log("Tracked ajax form submission by clicking submit button"),this.combFormForEmail(e)},{once:!0})}}trackKlaviyoForms(e){console.log("klaviyo form submitted",e),console.log("klaviyo event type",e.detail.type);let t,i=e.detail.type;if(i=="submit"||i=="stepSubmit"){let n=document.querySelector(`.klaviyo-form-${e.detail.formId}`);n&&(t=n.querySelector("form"));let o=e.detail.metaData.$email;if(o)v({email:o.trim()});else return;i=="submit"?this.captureSubscriber({form:t}):i=="stepSubmit"&&setTimeout(this.captureSubscriber({form:t}),1e3)}}trackPicoForms(e){console.log("pico form submitted",e),console.log("pico event email",e.detail.email.trim()),v({email:e.detail.email.trim()}),this.captureSubscriber()}trackOptinMonsterForms(e){console.log("optinMonster form submitted",e),console.log("optinMonster event email",e.detail.Optin.data.fields.email.trim()),v({email:e.detail.Optin.data.fields.email.trim()}),this.captureSubscriber()}trackElementorForms(){if(window.jQuery){let e=!!jQuery.fn.on,t=i=>this.combFormForEmail(i.target);e?jQuery(document).on("submit_success",t):jQuery(document).bind("submit_success",t)}}trackMemberSpaceForms({detail:e}){console.log("memberSpace form submitted",e);let{order:t,plan:i,member:n}=e;v({email:n.email.trim()}),this.captureSubscriber()}trackSquareSpaceForms(){var e=this;typeof Y<"u"&&typeof Y.all=="function"&&Y.all("form").each(function(t){t.on("submit",function(i){let n;typeof t._node=="string"?n=document.querySelector(t._node):n=t._node,n&&!mt(n)&&e.combFormForEmail(n)})})}trackConvertKitForms(e){console.log("ConvertKit form submitted",e),console.log("ConvertKit event email",e.detail.email_address.trim()),v({email:e.detail.email_address.trim()}),e.detail.recommendations&&v({upscribeBlocked:!0}),this.captureSubscriber({form:e.target})}trackEmailOctopusForms(e){console.log("emailoctopus form submitted",e),console.log("emailoctopus event detail",e.detail);let t=document.querySelector("[eo-block='form']").querySelector("form")||document.querySelector(".emailoctopus-form");if(t){let i=e.detail.contact.email_address||t.querySelector("input[type=email]").value;v({email:i.trim()}),this.captureSubscriber({form:t})}}trackClickFunnelsForms(e){console.log("clickfunnels form submitted",e),console.log("clickfunnels event detail",e.detail);let t=e.detail.contact?.email;t&&(v({email:t.trim()}),this.captureSubscriber())}trackGravityForms(e){console.log("gravity form submitted",e),console.log("gravity event detail",e.detail),gform!==void 0&&gform.utils.addAsyncFilter("gform/submission/pre_submission",async t=>{let i=gform.utils.getNode(".gfield--type-email input",t.form,!0);i&&(v({email:i.trim()}),this.captureSubscriber({form:t.form}))})}trackWisepopsForms(){window.wisepops&&wisepops("listen","after-form-submit",e=>{console.log("wisepops form submitted",e),console.log("wisepops event detail",e.detail);let t=e.target.elements.email;t&&(v({email:t.value.trim()}),this.captureSubscriber({form:e.target}))})}combFormForEmail(e){if(this.submittedFormsIds.includes(e.dataset.formId))return;let t=Je(e);t&&t.value&&(q("form-submitted"),console.log("email input detected",t),this.submittedFormsIds.push(e.dataset.formId),v({email:t.value.trim()}),this.captureSubscriber({form:e}))}async captureSubscriber({form:e=null}={}){let t=Ie();if(!t.email){console.log("No email found in the form submission");return}if(console.log("\u2705 Form submission tracked succesfully. Email captured: "+t.email),F()&&(window.onbeforeunload=function(){return"Are you sure you want to leave?"}),Z())if(ae()){this.completePartnerVerification();return}else{if(xe()){this.completeCampaignVerification(t);return}if(O()){this.completeUpscribeVerification(e);return}if(Ke()){this.completePartnerProgramVerification();return}}try{if(this.loadUpscribe(e),ze()){let n=await or(t);$(n.subscriber)}else console.log("Skipping subscriber tracking - no referral or partner link detected")}catch(i){console.log(i)}}async completePartnerVerification(){F()&&console.log("DEBUG: completePartnerVerification() called");try{let e=k("SLVerifyInstall");if(e){let t=await fr(e);F()&&console.log("DEBUG: completePartnerVerification() response",t),_e("[Step 3 of 3] Referral tracking working successfully","Your test referral was successful. You can now safely recommend this publication via your partner link."),setTimeout(()=>{window.open(`${this.config.app_url}/partner_profile/partner_campaigns/${e}`)},2500)}}catch(e){console.log(e.message)}}async completeCampaignVerification(e){try{let t=k("SLVerifyInstall");e.campaign_id=t,await cr(e),_e("[Step 3 of 3] Referral tracking working successfully",`SparkLoop was able to track the referral correctly via your form.

PS: If your form normally redirects to another page, don't worry. We have temporarily disabled the redirect to test the referral.

\u{1F449} you'll be redirected back to SparkLoop in a few seconds...`),setTimeout(()=>{window.open(`${this.config.app_url}/campaigns/${t}/checklist/script?verified=true`,"_blank")},4e3)}catch(t){console.log(t.message)}}async completeUpscribeVerification(e){F()&&console.log("DEBUG: completeUpscribeVerification() called");try{let t=k("SLVerifyInstall");await pr(t),F()&&console.log(`DEBUG: Upscribe ID ${t}`),this.loadUpscribe(e),_e("[Step 3 of 3] Signup tracking working successfully","SparkLoop was able to track the signup correctly via your form.<br/><br/>PS: If your form normally redirects to another page, don't worry. We have temporarily disabled the redirect to test the referral.<br/><br/>\u{1F449} you'll be redirected back to SparkLoop in a few seconds...")}catch(t){console.log(t.message)}}async completePartnerProgramVerification(){F()&&console.log("DEBUG: completePartnerProgramVerification() called");try{let e=k("SLVerifyInstall");await mr(e),F()&&console.log(`DEBUG: PartnerProgram ID ${testPartnerProgramReferral}`),_e("[Step 3 of 3] Signup tracking working successfully","SparkLoop was able to track the signup correctly via your form.<br/><br/>PS: If your form normally redirects to another page, don't worry. We have temporarily disabled the redirect to test the referral.<br/><br/>\u{1F449} you'll be redirected back to SparkLoop in a few seconds..."),setTimeout(()=>{window.open(`${this.config.app_url}/partner_programs/${e}/checklist?script_verified=true`,"_blank")},4e3)}catch(e){console.log(e.message)}}getUpscribeId(e){if(F()&&console.log("DEBUG: getUpscribeId() called"),F()&&console.log(`DEBUG: form ${e}`),xe())return;let t=this.config.widgets.upscribes.find(i=>{if(!O()&&!i.enabled)return console.log(`Upscribe ${i.uuid} is not enabled`),!1;if(i.visibility.installation!="widget")return console.log(`Upscribe ${i.uuid} is not set to be displayed as a widget`),!1;if(i.visibility.all_pages)return!0;let n=ke(),o=i.visibility.rules.find(s=>{let a=me(s);return n.match(a)});return o?(console.log(`Upscribe ${i.uuid} is set to be displayed on ${o}`),!0):(console.log(`Can't find a matching rule for Upscribe ${i.uuid}`),!1)});return F()&&console.log(`DEBUG: upscribe ${t}`),t?e?e.dataset.sparkloopUpscribe!=="false"?t.uuid:null:t.uuid:null}async loadUpscribe(e=null){if(F()&&console.log("DEBUG: loadUpscribe() called"),SL.config.upscribeDisabled){console.log("Upscribe is disabled");return}if(ae()){console.log("Upscribe is disabled in partner mode");return}if(v().upscribeShown){console.log("Upscribe has already been shown to this visitor");return}if(v().upscribeBlocked){console.log("Upscribe has been blocked for this visitor");return}let t=this.getUpscribeId(e);F()&&console.log(`DEBUG: upscribeId ${t}`),t&&(v({upscribeShown:!0}),new le().load(t))}};var Ki={"":["<em>","</em>"],_:["<strong>","</strong>"],"*":["<strong>","</strong>"],"~":["<s>","</s>"],"\n":["<br />"]," ":["<br />"],"-":["<hr />"]};function Or(r){return r.replace(RegExp("^"+(r.match(/^(\t| )+/)||"")[0],"gm"),"")}function Le(r){return(r+"").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function ee(r,e){var t,i,n,o,s,a=/((?:^|\n+)(?:\n---+|\* \*(?: \*)+)\n)|(?:^``` *(\w*)\n([\s\S]*?)\n```$)|((?:(?:^|\n+)(?:\t|  {2,}).+)+\n*)|((?:(?:^|\n)([>*+-]|\d+\.)\s+.*)+)|(?:!\[([^\]]*?)\]\(([^)]+?)\))|(\[)|(\](?:\(([^)]+?)\))?)|(?:(?:^|\n+)([^\s].*)\n(-{3,}|={3,})(?:\n+|$))|(?:(?:^|\n+)(#{1,6})\s*(.+)(?:\n+|$))|(?:`([^`].*?)`)|(  \n\n*|\n{2,}|__|\*\*|[_*]|~~)/gm,u=[],c="",l=e||{},d=0;function f(h){var w=Ki[h[1]||""],x=u[u.length-1]==h;return w?w[1]?(x?u.pop():u.push(h),w[0|x]):w[0]:h}function g(){for(var h="";u.length;)h+=f(u[u.length-1]);return h}for(r=r.replace(/^\[(.+?)\]:\s*(.+)$/gm,function(h,w,x){return l[w.toLowerCase()]=x,""}).replace(/^\n+|\n+$/g,"");n=a.exec(r);)i=r.substring(d,n.index),d=a.lastIndex,t=n[0],i.match(/[^\\](\\\\)*\\$/)||((s=n[3]||n[4])?t='<pre class="code '+(n[4]?"poetry":n[2].toLowerCase())+'"><code'+(n[2]?' class="language-'+n[2].toLowerCase()+'"':"")+">"+Or(Le(s).replace(/^\n+|\n+$/g,""))+"</code></pre>":(s=n[6])?(s.match(/\./)&&(n[5]=n[5].replace(/^\d+/gm,"")),o=ee(Or(n[5].replace(/^\s*[>*+.-]/gm,""))),s==">"?s="blockquote":(s=s.match(/\./)?"ol":"ul",o=o.replace(/^(.*)(\n|$)/gm,"<li>$1</li>")),t="<"+s+">"+o+"</"+s+">"):n[8]?t='<img src="'+Le(n[8])+'" alt="'+Le(n[7])+'">':n[10]?(c=c.replace("<a>",'<a href="'+Le(n[11]||l[i.toLowerCase()])+'">'),t=g()+"</a>"):n[9]?t="<a>":n[12]||n[14]?t="<"+(s="h"+(n[14]?n[14].length:n[13]>"="?1:2))+">"+ee(n[12]||n[15],l)+"</"+s+">":n[16]?t="<code>"+Le(n[16])+"</code>":(n[17]||n[1])&&(t=f(n[17]||"--"))),c+=i,c+=t;return(c+r.substring(d)+g()).replace(/^\n+|\n+$/g,"")}var p=m,Ue=class{constructor({referral_hub:e={}}={}){this.config=U(),this.referral_hub=e}animateCSS=(e,t)=>new Promise((i,n)=>{e.classList.add(t);function o(s){s.stopPropagation(),e.classList.remove(t),i("Animation ended")}e.addEventListener("animationend",o,{once:!0})});socialSharingLink=(e,t)=>{let i;return t==="facebook"?i="https://www.facebook.com/sharer.php?u="+encodeURIComponent(this.referralLink("facebook")):t==="twitter"?i="https://twitter.com/intent/tweet?text="+encodeURIComponent(e.twitter.message+`

`+this.referralLink("twitter")):t==="email"?i="mailto:?subject="+encodeURIComponent(e.email.subject)+"&body="+encodeURIComponent(e.email.message+`

`+this.referralLink("email")):t==="whatsapp"?i="https://api.whatsapp.com/send?text="+encodeURIComponent(e.whatsapp.message+`

`+this.referralLink("whatsapp")):t==="facebook_messenger"?i=this.messengerLink():t==="linkedin"?i="https://www.linkedin.com/shareArticle?mini=true&url="+encodeURIComponent(this.referralLink("linkedin")):t==="reddit"?i="https://www.reddit.com/submit?url="+encodeURIComponent(this.referralLink("reddit"))+"&title="+e.reddit.message:t==="telegram"?i="https://t.me/share/url?url="+encodeURIComponent(this.referralLink("telegram"))+"&text"+encodeURIComponent(e.telegram.message):t==="line"&&(i="https://line.me/R/msg/text/?"+encodeURIComponent(e.line.message+`

`+this.referralLink("line"))),i};referralLink=(e=null)=>{let t=$();if(t){let i=t.referral_link;return e&&(i+=`?utm_source=${e}`),i}else return this.config.app_url+"?rh_ref=ABC123"};messengerLink=()=>{let e;return/Mobi|Android/i.test(navigator.userAgent)?e="fb-messenger://share?redirect_uri="+encodeURIComponent(this.config.default_url)+"&amp;link="+encodeURIComponent(this.referralLink("facebook_messenger")):e="https://www.facebook.com/dialog/send?app_id=189109296592814&link="+encodeURIComponent(this.referralLink("facebook_messenger"))+"&redirect_uri="+encodeURIComponent(this.config.default_url),e};poweredByLink=(e,t,i="")=>{let n=`https://sparkloop.app/${i}?utm_campaign=powered-by&utm_source=${e}&utm_medium=${this.config.uuid}`;return p({type:"a",attributes:{href:n,target:"_blank"},text:"\u26A1\uFE0F by SparkLoop",parent:t})};formWidget=({onSubmit:e})=>{let{form_widget:t}=this.referral_hub;t.cover_image.enabled&&ne(t.cover_image.url);let i=p({id:"sl-form-screen",classes:"sl-widget-body"});if(t.cover_image.enabled){i.classList.add("sl-cover-image","sl-cover-image--"+t.cover_image.position);let h=p({type:"figure",parent:i});p({type:"img",attributes:{src:t.cover_image.url},parent:h})}let n=p({type:"section",id:"sl-form-section",classes:"sl-form-section",parent:i}),o=p({classes:"sl-form-content",parent:n});t.header&&p({type:"h2",html:ee(t.header),parent:o}),t.subheader&&p({type:"p",html:ee(t.subheader),parent:o});let s=p({type:"form",parent:n,attributes:{"data-sparkloop-form-ignore":!0}}),a=p({classes:"sl-form-container",parent:s});if(t.form.name_input.enabled){let h={type:"text",name:"name",placeholder:t.form.name_input.placeholder};T()||(h.required=!0),p({type:"input",attributes:h,parent:a})}let u={type:"email",name:"email",placeholder:t.form.email_input.placeholder};T()||(u.required=!0);let c=p({type:"input",attributes:u,parent:a}),l=p({type:"button",attributes:{type:"submit"},classes:"sl-button",text:t.form.button.label,parent:a});s.addEventListener("submit",h=>{h.preventDefault(),h.stopPropagation(),c.value.length>0&&(l.disabled=!0,e(c.value).catch(w=>{console.log(w),l.disabled=!1}))});let d=p({type:"footer",parent:n});t.tabs.how_it_works.enabled&&(p({type:"a",attributes:{href:"#"},text:t.tabs.how_it_works.label,parent:d}).addEventListener("click",w=>{w.preventDefault(),w.stopPropagation(),this.animateCSS(n,"sl-fadeOutLeft").then(x=>{n.style.display="none",f.style.display="flex"})}),p({type:"span",text:"|",parent:d})),t.tabs.terms.enabled&&(p({type:"a",attributes:{href:"https://"+t.tabs.terms.url},text:t.tabs.terms.label,parent:d}),p({type:"span",text:"|",parent:d})),this.referral_hub.styling.powered_by_enabled&&this.poweredByLink("referral-hub",d);let f=p({type:"section",id:"sl-how-it-works-section",classes:"sl-section-large",parent:i});return f.style.display="none",p({type:"a",classes:"sl-back-button",html:`
              <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                 viewBox="0 0 512 512" style="enable-background:new 0 0 512 512;" xml:space="preserve">
              <g>
                <path d="M256,0C114.8,0,0,114.8,0,256s114.8,256,256,256s256-114.8,256-256S397.2,0,256,0z M256,39.4
                  c119.8,0,216.6,96.8,216.6,216.6S375.8,472.6,256,472.6S39.4,375.8,39.4,256S136.2,39.4,256,39.4z M196.9,177.2L118.2,256
                  l78.8,78.8v-59.1h196.9v-39.4H196.9V177.2z"/>
              </g>
              </svg>
              <span>Back</span>
            `,attributes:{href:"#"},parent:f}).addEventListener("click",h=>{h.preventDefault(),h.stopPropagation(),this.animateCSS(f,"sl-fadeOutRight").then(w=>{n.style.display="flex",f.style.display="none"})}),p({type:"h2",text:t.tabs.how_it_works.label,parent:f}),p({type:"article",html:ee(t.tabs.how_it_works.content),parent:f}),i};rewardsElement=()=>{let e=$();if(!e)return;let{hub_widget:t}=this.referral_hub,i=t.rewards.list,n=t.rewards.layout,o=p({type:"ul",id:"sl-rewards-section"});return o.classList.add(`sl-rewards-layout-${n}`),i.forEach((s,a)=>{a++;let u=e.rewards_won.includes(s.id),c=p({type:"li",classes:"sl-reward",parent:o});u&&c.classList.add("sl-reward-won");let l=p({type:"figure",classes:"sl-reward-image",parent:c});l.style.backgroundImage='url("'+s.image+'")';let d=p({classes:"sl-reward-referrals",parent:l});p(u?{type:"span",parent:d,html:`<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 36 36'>
                            <path fill='#fff' d="M12.8,28.7l-9.5-9.5c-0.4-0.4-0.4-1.1,0-1.6l1.5-1.5c0.4-0.4,1.1-0.4,1.6,0l7.2,7.2   l16-16c0.4-0.4,1.1-0.4,1.6,0l1.5,1.5c0.4,0.4,0.4,1.1,0,1.6L14.4,28.7C13.9,29.1,13.2,29.1,12.8,28.7z"/>
                          </svg>`}:{type:"span",text:s.referrals,parent:d});let f=p({classes:"sl-reward-info",parent:c});if(p({type:"h4",text:s.name,parent:f}),s.description)if(n=="horizontal"){let g=p({classes:"sl-reward-description hide",parent:l});p({type:"p",text:s.description,parent:g}),p({type:"span",parent:f,html:`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill='currentColor'>
                          <path fill='currentColor' d="M12,2A10,10,0,1,0,22,12,10.01114,10.01114,0,0,0,12,2Zm0,18a8,8,0,1,1,8-8A8.00917,8.00917,0,0,1,12,20Zm0-8.5a1,1,0,0,0-1,1v3a1,1,0,0,0,2,0v-3A1,1,0,0,0,12,11.5Zm0-4a1.25,1.25,0,1,0,1.25,1.25A1.25,1.25,0,0,0,12,7.5Z"/>
                        </svg>`}).addEventListener("click",function(w){g.classList.toggle("hide")})}else p({type:"p",text:s.description,parent:f});i.length<6||a==1||a==i.length||(i.length%5==0?a%5==0&&(c.classList.add("sl-before-break"),p({type:"span",classes:"sl-reward-break",parent:o})):i.length%4==0?a%4==0&&(c.classList.add("sl-before-break"),p({type:"span",classes:"sl-reward-break",parent:o})):i.length%3==0?a%3==0&&(c.classList.add("sl-before-break"),p({type:"span",classes:"sl-reward-break",parent:o})):a%4==0&&(c.classList.add("sl-before-break"),p({type:"span",classes:"sl-reward-break",parent:o})))}),o};sharingElement=()=>{if(!$())return;let{hub_widget:t}=this.referral_hub,i=p({type:"section",id:"sl-sharing-section"}),n=p({id:"sl-sharinglink-container",parent:i});if(p({type:"p",text:t.sharing.referral_link.header,parent:n}),n.appendChild(this.referralLinkElement()),t.sharing.social_links.enabled){let o=p({id:"sl-sociallinks-container",parent:i});p({type:"p",text:t.sharing.social_links.header,parent:o}),o.appendChild(this.socialIconsElement())}if(t.sharing.email_invitation.enabled){let o=p({id:"sl-emailinvitation-container",parent:i});p({type:"p",text:t.sharing.email_invitation.header,parent:o});let s=p({type:"span"});o.appendChild(this.emailInvitationElement(s)),o.appendChild(s)}return i};referralLinkElement=()=>{let e=$();if(!e)return;let{sharing:t}=this.referral_hub.hub_widget,i=p({type:"form",attributes:{"data-sparkloop-form-ignore":!0}}),n=p({type:"input",parent:i,attributes:{type:"text",readonly:!0,value:e.referral_link}}),o=p({type:"button",classes:"sl-button",parent:i,text:t.referral_link.button.label});return o.addEventListener("click",s=>{s.preventDefault(),Zt(n,o,t.referral_link.button.label)}),i};statsElement=()=>{let e=$();if(!e)return;let{referrals:t}=this.referral_hub.hub_widget,i=p({type:"section",id:"sl-referrals-section"});if(t.confirmed.enabled){let n=p({id:"sl-confirmed-referrals",parent:i});p({type:"h3",text:Ze(e.referrals.confirmed),parent:n}),p({type:"span",text:t.confirmed.label,parent:n})}if(t.pending.enabled){let n=p({id:"sl-pending-referrals",parent:i});p({type:"h3",text:Ze(e.referrals.pending),parent:n}),p({type:"span",text:t.pending.label,parent:n})}if(t.next.enabled){let n=p({id:"sl-next-referrals",parent:i});p({type:"h3",text:Ze(e.next_reward),parent:n}),p({type:"span",text:t.next.label,parent:n})}return i};socialIconsElement=()=>{if(!$())return;let{hub_widget:t}=this.referral_hub,i=p({id:"sl-sociallinks-icons"});return["twitter","facebook","email","whatsapp","linkedin","telegram"].forEach(o=>{if(t.sharing.social_links.socials[o].enabled){let s=p({type:"a",classes:"sl-social",id:`sl-social-${o}`,attributes:{title:`Share on ${o}`,href:this.socialSharingLink(t.sharing.social_links.socials,o)}});s.style.backgroundImage="url(https://sparkloop-static-images.s3-us-west-1.amazonaws.com/"+o+".png)",i.appendChild(s)}}),i};emailInvitationElement=e=>{let t=$();if(!t)return;let{email_invitation:i}=this.referral_hub.hub_widget.sharing,n=p({type:"form",attributes:{"data-sparkloop-form-ignore":!0}}),o=p({type:"input",parent:n,classes:"sl-widget-input",attributes:{type:"text",placeholder:i.placeholder}}),s=p({type:"button",classes:"sl-button",parent:n,text:i.button.label});return s.addEventListener("click",async a=>{a.preventDefault(),a.stopPropagation(),s.disabled=!0,e.innerText="";let u=o.value.trim();if(u.length>0){let c={campaign_id:this.referral_hub.campaign_id,subscriber:t.id,recipients:u};try{await _r(c),o.value="",e.innerText=i.confirmation_message}catch{e.innerText="Server error. Please try again."}finally{s.disabled=!1}}}),n};hubWidget=()=>{if(!$())return;let{hub_widget:t}=this.referral_hub;t.rewards.list.forEach(o=>{ne(o.image)});let i=p({id:"sl-hub-screen",classes:"sl-widget-body"});if(t.header&&t.header.trim().length>0||t.subheader&&t.subheader.trim().length>0){let o=p({type:"header",parent:i});t.header&&t.header.trim().length>0&&p({type:"h2",html:ee(t.header),parent:o}),t.subheader&&t.subheader.trim().length>0&&p({type:"p",html:ee(t.subheader),parent:o})}t.rewards.enabled&&t.rewards.list.length>0&&i.appendChild(this.rewardsElement());let n=p({type:"main",id:"sl-hub-main",parent:i});if(n.appendChild(this.sharingElement()),(t.referrals.confirmed.enabled||t.referrals.pending.enabled||t.referrals.next.enabled)&&n.appendChild(this.statsElement()),this.referral_hub.styling.powered_by_enabled){let o=p({id:"sl-hub-powered-by",parent:i});this.poweredByLink("referral-hub",o)}return i}};var fe=class{constructor(){this.config=U(),this.referral_hub={}}async load(){if(this.loadDefaultStyles(),this.config.widgets.referral_hubs.length&&(this.fetchReferralHubSettings(),Object.keys(this.referral_hub).length)){try{await new X().fetch({campaign:this.referral_hub.campaign_id})}catch{console.error("Subscriber was not found")}T()&&pt()&&J("Referral Hub Preview",'To visualize the hub widget, signup using any name<br/>and "test@test.com" as email address.<br>When test mode is enabled no email will be recorded.'),this.loadReferralHubStyles(),this.loadReferralHubWidget(),this.generateReferralHubElements()}}components(){return Kt()?new Ue({referral_hub:this.referral_hub}):tr()}fetchReferralHubSettings(e){let t=this.config.widgets.referral_hubs;if(e)this.referral_hub=t.find(i=>i.campaign_id==e);else{let i=document.querySelector("#sparkloop-referral-hub")||document.querySelector("[class*=sparkloop-][data-campaign-id]");if(i){let n=i.dataset.campaignId;this.referral_hub=n?t.find(o=>o.campaign_id==n):t[0]}}}loadReferralHubWidget(){let e=document.querySelector("#sparkloop-referral-hub");!e||($()?e.replaceChildren(this.generateHubWidget()):e.replaceChildren(this.generateFormWidget()))}generateFormWidget(){return this.components().formWidget({onSubmit:e=>this.validateAndHydrateSubscriber(e)})}generateHubWidget(){return this.components().hubWidget()}generateRewardsElement(){return this.components().rewardsElement()}generateSharingElement(){return this.components().sharingElement()}generateStatsElement(){return this.components().statsElement()}generateReferralHubElements(){if($()){let e=(t,i)=>{let n=document.createElement("div");n.className="sl-widget-body sl-referral-hub-element",n.appendChild(i),t.replaceChildren(n)};document.querySelectorAll(`.sparkloop-rewards-element[data-campaign-id=${this.referral_hub.campaign_id}]`).forEach(t=>{e(t,this.generateRewardsElement())}),document.querySelectorAll(`.sparkloop-sharing-element[data-campaign-id=${this.referral_hub.campaign_id}]`).forEach(t=>{e(t,this.generateSharingElement())}),document.querySelectorAll(`.sparkloop-stats-element[data-campaign-id=${this.referral_hub.campaign_id}]`).forEach(t=>{e(t,this.generateStatsElement())})}}async validateAndHydrateSubscriber(e){try{await new X().upsert({subscriber:e,campaign:this.referral_hub.campaign_id}),this.loadReferralHubWidget(),this.generateReferralHubElements()}catch(t){q("subscriber-not-loaded"),console.log(`Subscriber not loaded ${t}`)}}loadDefaultStyles(){Jt(),Re("default")}loadReferralHubStyles(){Re("referral_hub"),document.documentElement.style.setProperty("--sl-widgets-referral-hub-primary-color",this.referral_hub.styling.colors.primary),document.documentElement.style.setProperty("--sl-widgets-referral-hub-secondary-color",this.referral_hub.styling.colors.secondary),document.documentElement.style.setProperty("--sl-widgets-referral-hub-headers-color",this.referral_hub.styling.colors.headers),Ye("referral_hub",this.referral_hub.styling.custom_css)}};var Ae=class{constructor(){this.config=U(),this.signup_email="signup@sparkloop.co"}timeoutTime(){return k("timeout")?parseInt(k("timeout")):15e3}async run(){if(Z()){let e;if(ae())J("[Step 1 of 3]  Referral testing process initiated","\u23F1 checking for a valid signup form on the page"),this.verifyReferralTracking();else try{let t=k("SLVerifyInstall");if(xe())e=await ar({campaign_id:t});else if(O()){if(console.log("upscribe settings",Ce(t)),Ce(t)==null)throw"Upscribe settings not found";e=await ur(t)}else Ke()&&(e=await dr(t));console.log("script verified successfully",e),J("[Step 1 of 3] Script found on page","Your SparkLoop tracking script is correctly installed on this page.<br/><br/>\u{1F449} let's make sure SparkLoop can identify your email signup form(s)."),this.verifyReferralTracking()}catch(t){console.error("script verification failed",t),ct("Script verification failed","Please reload the page and try again.")}}}fetchForms(){return document.querySelectorAll(this.config.form_selector||"form")}verifyReferralTracking(){setTimeout(()=>{this.fetchForms().length?this.verifyForm():Xt(this.fetchForms())?Se("Gravity form detected","SparkLoop has detected a broken Gravity form on this page. <a href='https://help.sparkloop.app/en/articles/5855767-installing-the-tracking-script-on-wordpress#h_f004b7693e' target='_blank'>See instructions</a> on how to fix it"):(Se("We can't detect a valid form on this page","SparkLoop will try for another 15 seconds.<br/><br/>\u{1F449} if the form is inside a popup, try opening it (make the form appear on the page)"),setTimeout(()=>{this.fetchForms().length?this.verifyForm():ct("Bad news \u{1F61E}",`SparkLoop couldn't detect a valid form on this page.

If you get this error but the form is visible on the page, it's possible that the form is inside an iFrame or otherwise incompatible with our SparkLoop tracking script.

\u{1F449} contact our support team (support@sparkloop.app) to find a solution.`)},this.timeoutTime()))},1500)}verifyForm(){ae()?J("[Step 2 of 3] Make a test referral",`\u{1F449} Subscribe to this publication via the opt-in form on the page, using the email address <strong>${this.signup_email}</strong><br/><br/>Then wait up to 10 seconds for a success message to be shown.`):J("[Step 2 of 3] Valid form found",`SparkLoop has detected a valid email signup form on this page.

Now we need to check that our tracking script can track signups correctly via your form.<br/><br/><strong>\u{1F449} fill out and submit your form using the email address ${this.signup_email}</strong>`),new oe().track(),setTimeout(()=>{window.SL.visitor.email||(ae()?Se("Signup not yet detected",`We haven't been able to detect a valid referral yet.<br/><br/>If you haven't already followed the instructions in Step #2 (above), do so now.<br/><br/>If you have already subscribed with ${this.signup_email} and are seeing this message, it means referral tracking is broken for this publication. You should contact us via support@sparkloop.app and <strong>do not recommend</strong> this publication until the issue has been fixed.`):Se("Signup not yet detected",`SparkLoop hasn't been able to detect a valid signup yet.

\u{1F449} if you haven't submitted the form yet using ${this.signup_email}, please do so now.

If you have submitted the email signup form correctly, it's likely there's an error in the form which prevents us from tracking referrals correctly.

In this case, please contact our support team (support@sparkloop.app) and we'll help you find an easy solution!`))},this.timeoutTime())}};var Ct=wi(di());var xt=class{constructor(e){this.config=e}widgets(e){let t=new fe;return t.fetchReferralHubSettings(e),t.loadReferralHubStyles(),t}async upscribe(e,t=null,i=!0,n=!1){try{return t&&v({email:t.trim()}),new le().load(e,i,n)}catch(o){console.error(o)}}generate={rewardsElement:e=>this.widgets(e).generateRewardsElement(),sharingElement:e=>this.widgets(e).generateSharingElement(),statsElement:e=>this.widgets(e).generateStatsElement(),formWidget:e=>this.widgets(e).generateFormWidget(),hubWidget:e=>this.widgets(e).generateHubWidget(),upscribeWidget:(e,t)=>this.upscribe(e,t,!1),upscribePopup:(e,t)=>this.upscribe(e,t,!0),upscribePreview:e=>this.upscribe(e,null,!1,!0)};reset(e){this.config=(0,Ct.default)(e,window.SLConfig)}trackSubscriber(e){e?(v({email:e.trim()}),new oe().captureSubscriber()):console.error("Email can't be blank.")}async getSubscriber(e,t=null){try{let n=await new X().fetch({subscriberId:e.trim(),campaign:t});return Promise.resolve(n)}catch(i){return console.log(i),Promise.reject(i)}}async run(){q("ready"),F()&&console.log("DEBUG MODE IS ON"),zt(),await new Pe().profile(),new Ae().run(),new oe().track();try{await new X().fetch()}catch(o){q("subscriber-not-loaded"),console.log(o)}new fe().load()}},Vs=(r,e=null)=>{if(window.SLScriptLoaded=window.SLScriptLoaded||!1,window.SLScriptLoaded)return console.warn("SparkLoop is already loaded. Please check if you have multiple instances of the script on the same page."),!1;if(window.SLScriptLoaded=!0,!r.active)return console.warn("Sparkloop is disabled because the account is not active."),!1;let t=(0,Ct.default)(e||window.SL||{},r);if(window.SLConfig=r,t.disabled)return console.warn("SparkLoop has been manually disabled."),!1;t.test_mode&&console.warn("SparkLoop is running in test mode."),console.log("\u{1F64C} SparkLoop is loaded, time to rock'n'roll!"),console.log("Looking to grow your newsletter? Check out https://sparkloop.app/console");let i=new xt(t);window.SL=i,i.run()};{let r=async()=>{setTimeout(async()=>{let e=ir(),t=nr();if(!e){console.log("\u274C SparkLoop UUID not found");return}if(!t){console.log("\u274C SparkLoop settings base URL not found");return}try{let i=await Cr(t,e);console.log(`\u2705 SparkLoop settings loaded for ${e}`),Vs(i)}catch(i){console.log(`\u274C SparkLoop settings failed to load for ${e}`),console.error(i)}},window.sparkloop_delay||800)};document.readyState!=="loading"?r():(document.addEventListener("DOMContentLoaded",()=>r()),document.addEventListener("turbo:load",()=>r()))}})();
/*! js-cookie v3.0.1 | MIT */
